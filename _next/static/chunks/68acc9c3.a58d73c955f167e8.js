"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[642],{77376:function(t,e,i){let n,o;i.r(e),i.d(e,{WebLayoutEntryPoint:function(){return eX}});var s,r,a,l,h,d,m,c,u,p,g,f,v,_,y,C,w,I,b,S,E,x,L,z,M,P,T,A,k,D,R,U,V,O,B,W,H,F,N,$,j,G,Z,q,X,Y,K,J,Q,tt,te,ti,tn,to,ts,tr,ta=i(95627),tl=i(55445),th=i.n(tl),td=i(9315);i(82957),i(59128),i(21652);var tm={},tc={};Object.defineProperty(tc,"__esModule",{value:!0}),tc.mapValuesAsync=tc.mapEntriesAsync=void 0;let tu=(t,[e,i])=>({...t,[e]:i});async function tp(t,e){return(await Promise.all(e.map(async([e,i])=>[e,await t(i,e)]))).reduce(tu,{})}tc.mapEntriesAsync=tp,tc.mapValuesAsync=async function(t,e){return tp(t,e instanceof Map?[...e.entries()]:Object.entries(e))};var tg={};Object.defineProperty(tg,"__esModule",{value:!0}),tg.dispatchLayoutEvent=void 0,tg.dispatchLayoutEvent=function(t,e,i){if("openfin"===t.environment.type){let{uuid:n,name:o}=t.environment.getCurrentEntityIdentity(),s=`window/${e}/${n}-${o}`;t.environment.raiseEvent(s,{layoutIdentity:{layoutName:i,uuid:n,name:o},topic:"window"})}};var tf,tv,t_,ty,tC=ta.c&&ta.c.__classPrivateFieldSet||function(t,e,i,n,o){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!o)throw TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,i):o?o.value=i:e.set(t,i),i},tw=ta.c&&ta.c.__classPrivateFieldGet||function(t,e,i,n){if("a"===i&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(t):n?n.value:e.get(t)};Object.defineProperty(tm,"__esModule",{value:!0});var tI=tm.DefaultLayoutManager=void 0;class tb{constructor(t){tv.set(this,void 0),t_.set(this,new Map),tC(this,tv,t,"f")}size(){return tw(this,t_,"f").size}async applyLayoutSnapshot({layouts:t}){if(Object.keys(t).length>1)throw Error("[LayoutManager] Tried to call applyLayoutSnapshot with more than 1 layout. When implementing multiple layouts via overridden LayoutManager class, you must override and fully implement the applyLayoutSnapshot method without calling super.applyLayoutSnapshot().");let[[e,i]]=Object.entries(t);await tb.createLayout(this,{layoutName:e,layout:i}),(0,tg.dispatchLayoutEvent)(tw(this,tv,"f").getWire(),"layout-snapshot-applied",e)}async showLayout({layoutName:t}){}async getLayoutSnapshot(){return{layouts:await (0,tc.mapValuesAsync)(t=>t.getFrameSnapshot(),tw(this,t_,"f"))}}async removeLayout({layoutName:t}){}getLayoutIdentityForView(t){let e=[...tw(this,t_,"f").values()].find(e=>e.getCurrentViews().some(e=>e.name===t.name&&e.uuid===t.uuid));return e?.identity??void 0}isLayoutVisible({layoutName:t}){return tw(tb,tf,"m",ty).call(tb,this,t).isVisible()}resolveLayoutIdentity(t){if(t&&"layoutName"in t)return t;let e=[...tw(this,t_,"f").values()];if(1===e.length)return e[0].identity;let i=e.find(t=>t.isVisible());return i?.identity??void 0}static async resolveLayout(t,e){let i=t.resolveLayoutIdentity(e);if(void 0===i||!("layoutName"in i))throw Error("[layout-manager] resolveLayout: Could not resolve the layout identity. Make sure you include 'layoutName' in the identity object.");return tw(tb,tf,"m",ty).call(tb,t,i.layoutName)}static async handleSharedView(t,e,i){await (0,tc.mapValuesAsync)(async t=>{if(t.identity.layoutName!==e.layoutName){let e=t.getCurrentViews().find(t=>t.name===i.name);e&&await t.onViewDetached({viewIdentity:e,target:null}).catch(console.error)}},tw(t,t_,"f"))}static async handleLastViewRemoved(t,e){await t.removeLayout(e),await tw(t,tv,"f").handleLastViewRemoved(t)}static async destroyLayout(t,{layoutName:e}){await tw(tb,tf,"m",ty).call(tb,t,e).destroy(),tw(t,t_,"f").delete(e),(0,tg.dispatchLayoutEvent)(tw(t,tv,"f").getWire(),"layout-destroyed",e)}static async createLayout(t,e){let{layoutName:i}=e;if(tw(t,t_,"f").has(i))throw Error(`Layout name ${i} already exists`);await tw(t,tv,"f").createLayout(e,t),(0,tg.dispatchLayoutEvent)(tw(t,tv,"f").getWire(),"layout-created",i)}static registerLayout(t,e,i){tw(t,t_,"f").set(e,i)}static getAllLayouts(t){return[...tw(t,t_,"f").values()]}static setInitialSnapshot(t,e){tw(t,tv,"f").setInitialSnapshot(e)}static createClosedConstructor(...t){return class extends tb{constructor(){super(...t)}}}}tI=tm.DefaultLayoutManager=tb,tf=tb,tv=new WeakMap,t_=new WeakMap,ty=function(t,e){let i=tw(t,t_,"f").get(e);if(!i)throw Error(`[layout-manager] getLayoutByName: Could not locate layout with name '${e}'`);return i};var tS={},tE={},tx={};Object.defineProperty(tx,"__esModule",{value:!0}),tx.ReversibleMap=void 0,tx.ReversibleMap=class{constructor(){this.valueToKey=new Map,this.keyToValue=new Map,this.setUnique=(t,e)=>{if(this.hasKey(t)||this.hasValue(e))throw Error("Key or value already in the map.");this.keyToValue.set(t,e),this.valueToKey.set(e,t)},this.getKey=t=>{let e=this.valueToKey.get(t);if(!e)throw Error("Value not found in the map.");return e},this.deleteKey=t=>{let e=this.getValue(t);return this.keyToValue.delete(t),this.valueToKey.delete(e),e},this.deleteValue=t=>{let e=this.getKey(t);return this.keyToValue.delete(e),this.valueToKey.delete(t),e},this.hasKey=t=>this.keyToValue.has(t),this.hasValue=t=>this.valueToKey.has(t)}getValue(t){let e=this.keyToValue.get(t);if(!e)throw Error("Key not found in the map.");return e}},Object.defineProperty(tE,"__esModule",{value:!0});var tL=tE.LayoutContentCache=void 0;let tz=ta.l;class tM{constructor(){this.contentItemCache=new tx.ReversibleMap,this.contentItemCacheId=0,this.createCacheKey=()=>{let t=`entity-${this.contentItemCacheId.toString()}`;return this.contentItemCacheId+=1,t},this.hasKey=t=>this.contentItemCache.hasKey(t),this.getItemOrUndefined=t=>{try{return this.getContentItemOrThrow(t)}catch(t){return}},this.getContentItemOrThrow=(t,e)=>{if(!this.contentItemCache.hasKey(t))throw Error("Layout component has been destroyed or detached from the current layout.");let i=this.contentItemCache.getValue(t);if(e&&!e.includes(i.type))throw Error(`Layout item is not the expected type. Expected ${e.join(", ")}, got ${i.type}.`);return i},this.getOrCreateEntityId=t=>{if(this.contentItemCache.hasValue(t))return this.contentItemCache.getKey(t);t.onDestroyed(()=>{this.contentItemCache.deleteValue(t)});let e=this.createCacheKey();return this.contentItemCache.setUnique(e,t),e}}static getSingleInstance(){return tM.singleton.getValue()}}tL=tE.LayoutContentCache=tM,tM.singleton=new tz.Lazy(()=>new tM);var tP={},tT={};Object.defineProperty(tT,"__esModule",{value:!0}),tT.getAdjacentStacks=tT.doShareEdge=tT.getAdjacentItem=void 0,tT.getAdjacentItem=(t,e)=>{let{parent:i}=t;if(t.isRoot()||!i)return;let n=["top","bottom"].includes(e)?"column":"row",o=["top","left"].includes(e)?-1:1;if(i.type===n){let e=i.contentItems.indexOf(t)+o;if(e>=0&&e<i.contentItems.length)return i.contentItems[e]}return(0,tT.getAdjacentItem)(i,e)},tT.doShareEdge=(t,e,i)=>{let n=t.getBounds(),o=e.getBounds();return!!n&&!!o&&(["top","bottom"].includes(i)?!(n.right<o.left||n.left>o.right):!(n.bottom<o.top||n.top>o.bottom))},tT.getAdjacentStacks=(t,e)=>{let i=["top","bottom"].includes(e)?"row":"column",n=o=>"stack"===o.type?(0,tT.doShareEdge)(t,o,e)?[o]:[]:"root"===o.type||"ground"===o.type?[]:o.type===i?o.contentItems.map(t=>n(t)).flat():o.type!==i?["top","right"].includes(e)?n(o.contentItems[o.contentItems.length-1]):n(o.contentItems[0]):[],o=(0,tT.getAdjacentItem)(t,e);return o?n(o):[]};var tA=ta.c&&ta.c.__decorate||function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(tP,"__esModule",{value:!0}),tP.LayoutEntitiesController=void 0;let tk=ta.d;class tD{constructor(t,e,i){this.wire=t,this.layoutManager=e,this.layoutContentCache=i,this.analytics=t=>{this.wire.sendAction(`layout-controller-${t}`).catch(()=>{})},this.getLayoutIdentityForViewOrThrow=async t=>{let e=this.layoutManager.getLayoutIdentityForView(t);if(!e)throw Error(`View identity ${t.name} is not attached to any layouts.`);return e},this.getRoot=async t=>{this.analytics("get-root");let e=(await this.getLayout(t)).getRoot();return{type:e.type,entityId:this.layoutContentCache.getOrCreateEntityId(e)}},this.getStackByView=async t=>{this.analytics("get-stack-by-view");let e=await this.getLayoutIdentityForViewOrThrow(t),i=(await this.getLayout(e)).getStackByView(t);if("stack"===i?.type)return{entityId:this.layoutContentCache.getOrCreateEntityId(i),type:"stack"}},this.getStackViews=t=>(this.analytics("get-stack-views"),this.layoutContentCache.getContentItemOrThrow(t,["stack"]).contentItems.map(t=>({name:t.viewName,uuid:this.wire.me.uuid}))),this.isRoot=t=>(this.analytics("is-root"),this.layoutContentCache.getContentItemOrThrow(t).isRoot()),this.exists=t=>(this.analytics("exists"),this.layoutContentCache.hasKey(t)),this.addViewToStack=async(t,e,{index:i,displayState:n}={index:0,displayState:"focused"})=>{this.analytics("add-view-to-stack");let o=this.layoutContentCache.getContentItemOrThrow(t);if(i&&i>o.contentItems.length+1)throw Error(`Index '${i}' out of range, please exclude the index or specify a number between 0 and ${o.contentItems.length}`);let{identity:s}=await o.layout.platformCreateView(e,{location:{id:t,index:i,displayState:n}});return s},this.findViewInStack=(t,e)=>t.contentItems.find(t=>t.viewName===e.name),this.removeViewFromStack=async(t,e)=>{this.analytics("remove-view-from-stack");let i=this.layoutContentCache.getContentItemOrThrow(t,["stack"]),n=this.findViewInStack(i,e);if(!n)throw Error(`Tried to remove a view ('${e.name}') which does not belong to the stack.`);await n.layout.platformCloseView(e)},this.createAdjacentStack=async(t,e,{position:i="right"}={})=>{if(this.analytics("create-adjacent-stack"),!Array.isArray(e)||0===e.length)throw Error('The parameter "views" must be an array with at least 1 element.');if(!["top","bottom","left","right"].includes(i))throw Error(`Invalid position '${i}' specified.`);let n=this.layoutContentCache.getContentItemOrThrow(t).createAdjacentStack({position:i}),o=this.layoutContentCache.getOrCreateEntityId(n);return await Promise.all(e.reverse().map(t=>this.addViewToStack(o,t))),o},this.getAdjacentStacks=async({targetId:t,edge:e})=>{this.analytics("get-adjacent-stacks");let i=this.layoutContentCache.getContentItemOrThrow(t);return(0,tT.getAdjacentStacks)(i,e).map(t=>({entityId:this.layoutContentCache.getOrCreateEntityId(t)}))},this.setStackActiveView=async(t,e)=>{this.analytics("set-stack-active-view");let i=this.layoutContentCache.getContentItemOrThrow(t,["stack"]),n=this.findViewInStack(i,e);if(!n)throw Error(`Tried to set a view ('${e.name}') as active when it does not belong to the stack.`);i.setActiveContentItem(n,!0)}}async getLayout(t){let e=await tm.DefaultLayoutManager.resolveLayout(this.layoutManager,t);if(!e)throw Error(`Could not resolve target layout identity ${JSON.stringify(t)}`);return e}getContent(t){return this.analytics("get-content"),this.layoutContentCache.getContentItemOrThrow(t,["column","row"]).contentItems.map(t=>({type:t.type,entityId:this.layoutContentCache.getOrCreateEntityId(t)}))}getParent(t){this.analytics("get-parent");let e=this.layoutContentCache.getContentItemOrThrow(t);if(!e.isRoot())return e.parent?.contentItems.includes(e)?{type:e.parent.type,entityId:this.layoutContentCache.getOrCreateEntityId(e.parent)}:void 0}}tA([(0,tk.expose)()],tD.prototype,"getLayoutIdentityForViewOrThrow",void 0),tA([(0,tk.expose)()],tD.prototype,"getRoot",void 0),tA([(0,tk.expose)()],tD.prototype,"getStackByView",void 0),tA([(0,tk.expose)()],tD.prototype,"getStackViews",void 0),tA([(0,tk.expose)()],tD.prototype,"getContent",null),tA([(0,tk.expose)()],tD.prototype,"getParent",null),tA([(0,tk.expose)()],tD.prototype,"isRoot",void 0),tA([(0,tk.expose)()],tD.prototype,"exists",void 0),tA([(0,tk.expose)()],tD.prototype,"addViewToStack",void 0),tA([(0,tk.expose)()],tD.prototype,"removeViewFromStack",void 0),tA([(0,tk.expose)()],tD.prototype,"createAdjacentStack",void 0),tA([(0,tk.expose)()],tD.prototype,"getAdjacentStacks",void 0),tA([(0,tk.expose)()],tD.prototype,"setStackActiveView",void 0),tP.LayoutEntitiesController=tD,Object.defineProperty(tS,"__esModule",{value:!0});var tR=tS.initLayoutEndpoints=void 0;let tU=ta.a,tV=ta.b;tR=tS.initLayoutEndpoints=async function(t,e){let i=t.getFin(),n=await i.Platform.getCurrentSync().getClient(),o=new tU.ChannelsExposer(n);await new tU.ApiExposer(o).exposeInstance(new tP.LayoutEntitiesController(t,e,tE.LayoutContentCache.getSingleInstance()),{id:tV.LAYOUT_CONTROLLER_ID}),await async function(t,e){let i=t=>async i=>{let n=await tm.DefaultLayoutManager.resolveLayout(e,i.target);if(!n)throw Error(`Could not resolve the layout target from payload ${JSON.stringify(i)}`);return t(n,i)},n=(e,n)=>{t.register(e,i(n))},o=(t,e)=>{n(t,e)};n("replace-view",(t,e)=>t.replaceView(e)),n("replace-layout",(t,{layout:e})=>t.replaceLayout(e)),n("add-view",(t,e)=>t.insertView(e)),o("layout-add-view",(t,{viewOptions:e,location:i,targetView:n})=>t.platformCreateView(e,{location:i,targetView:n})),n("close-view",(t,e)=>t.cleanupView(e.viewIdentity)),o("layout-close-view",(t,e)=>t.platformCloseView(e.viewIdentity)),n("apply-preset-layout",(t,e)=>t.applyPreset(e)),n("get-layout-views",t=>t.getCurrentViews()),n("get-frame-snapshot",t=>t.getFrameSnapshot()),n("is-visible",t=>t.isVisible()),n("destroy",t=>t.destroy()),t.register("get-layout-snapshot",()=>e.getLayoutSnapshot())}(n,e)};var tO={};Object.defineProperty(tO,"__esModule",{value:!0});var tB=tO.BaseLayout=void 0;tB=tO.BaseLayout=class{};var tW={};Object.defineProperty(tW,"__esModule",{value:!0});var tH=tW.DOMEmitter=void 0;tH=tW.DOMEmitter=class{constructor(t){this.container=t}dispatchLocalEvent(t,e){let i={...e,type:t,tabSelector:`tab-${e.name}`,containerSelector:`container-${e.name}`,topic:"openfin-DOM-event"};this.container.dispatchEvent(new CustomEvent(t,{detail:i}))}};var tF={};Object.defineProperty(tF,"__esModule",{value:!0});var tN=tF.mapLayoutContentItemsImmutableSync=tF.mapLayoutContentItemsImmutable=t$=tF.isVisible=void 0,t$=tF.isVisible=t=>(0!==t.offsetWidth||0!==t.offsetHeight)&&"hidden"!==window.getComputedStyle(t).visibility&&t.offsetTop>=0&&t.offsetLeft>=0&&t.offsetTop<=window.innerHeight&&t.offsetLeft<=window.innerWidth;let tj=t=>"type"in t&&"component"===t.type;tF.mapLayoutContentItemsImmutable=async function t(e,i){return tj(i)?e(i):{...i,content:await Promise.all(i.content?.map(i=>t(e,i)))}},tN=tF.mapLayoutContentItemsImmutableSync=function t(e,i){return tj(i)?e(i):{...i,content:i.content?.map(i=>t(e,i))}};class tG extends Error{constructor(t,e){super(e),this.type=t}}class tZ extends tG{constructor(t,e){super("Configuration",t),this.node=e}}class tq extends tG{constructor(t){super("PopoutBlocked",t)}}class tX extends tG{constructor(t){super("API",t)}}class tY extends tG{constructor(t){super("Bind",t)}}class tK extends Error{constructor(t,e,i){super(`${t}: ${e}${void 0===i?"":": "+i}`)}}class tJ extends tK{constructor(t,e){super("Assert",t,e)}}class tQ extends tK{constructor(t,e,i){super("UnreachableCase",t,`${e}${void 0===i?"":": "+i}`)}}class t0 extends tK{constructor(t,e){super("UnexpectedNull",t,e)}}class t1 extends tK{constructor(t,e){super("UnexpectedUndefined",t,e)}}!function(t){let e=!1,i={PopoutCannotBeCreatedWithGroundItemConfig:{id:0,default:"Popout cannot be created with ground ItemConfig"},PleaseRegisterAConstructorFunction:{id:1,default:"Please register a constructor function"},ComponentTypeNotRegisteredAndBindComponentEventHandlerNotAssigned:{id:2,default:"Component type not registered and BindComponentEvent handler not assigned"},ComponentIsAlreadyRegistered:{id:3,default:"Component is already registered"},ComponentIsNotVirtuable:{id:4,default:"Component is not virtuable. Requires rootHtmlElement field/getter"},VirtualComponentDoesNotHaveRootHtmlElement:{id:5,default:'Virtual component does not have getter "rootHtmlElement"'},ItemConfigIsNotTypeComponent:{id:6,default:"ItemConfig is not of type component"},InvalidNumberPartInSizeString:{id:7,default:"Invalid number part in size string"},UnknownUnitInSizeString:{id:8,default:"Unknown unit in size string"},UnsupportedUnitInSizeString:{id:9,default:"Unsupported unit in size string"}};t.idCount=Object.keys(i).length;let n=Object.values(i);t.checkInitialise=function(){if(!e)for(let e=0;e<t.idCount;e++){let t=n[e];if(t.id!==e)throw new tJ("INSI00110",`${e}: ${t.id}`);t2[e]=t.default}e=!0}}(M||(M={}));let t2=Array(M.idCount);(s=P||(P={})).defaultComponentBaseZIndex="auto",s.defaultComponentDragZIndex="32",s.defaultComponentStackMaximisedZIndex="41",(r=T||(T={})).width="width",r.height="height",(a=A||(A={})).top="top",a.left="left",a.right="right",a.bottom="bottom",(l=k||(k={})).base="base",l.drag="drag",l.stackMaximised="stackMaximised";let t3={base:P.defaultComponentBaseZIndex,drag:P.defaultComponentDragZIndex,stackMaximised:P.defaultComponentStackMaximisedZIndex};function t9(t){return t.toString(10)+"px"}function t5(t){return parseFloat(t.replace("px",""))}function t7(t,e){let i=t9(e);t.style.width=i}function t8(t,e){let i=t9(e);t.style.height=i}function t4(t){return{width:t.offsetWidth,height:t.offsetHeight}}function t6(t,e){t.style.display=e?"":"none"}function et(t,e){if(void 0!==e){for(let i in e)if(e.hasOwnProperty(i)){let n=e[i],o=t[i];t[i]=ee(o,n)}}return t}function ee(t,e){if("object"!=typeof e)return e;if(Array.isArray(e)){let t=e.length,i=Array(t);for(let n=0;n<t;n++){let t=e[n];i[n]=ee({},t)}return i}return null===e?null:void 0===t||"object"!=typeof t||Array.isArray(t)||null===t?et({},e):et(t,e)}function ei(){return(1e15*Math.random()).toString(36).replace(".","")}function en(t,e){let{numericPart:i,firstNonNumericCharPart:n}=function(t){let e=(t=t.trimStart()).length;if(0===e)return{numericPart:"",firstNonNumericCharPart:""};{let i=e,n=!1;for(let o=0;o<e;o++){let e=t[o];if(!(e>="0"&&e<="9")){if("."!==e||n){i=o;break}n=!0}}return{numericPart:t.substring(0,i),firstNonNumericCharPart:t.substring(i).trim()}}}(t),o=Number.parseInt(i,10);if(isNaN(o))throw new tZ(`${t2[7]}: ${t}`);{let i=V.tryParse(n);if(void 0===i)throw new tZ(`${t2[8]}: ${t}`);if(e.includes(i))return{size:o,sizeUnit:i};throw new tZ(`${t2[9]}: ${t}`)}}function eo(t,e){return t.toString(10)+V.format(e)}function es(t,e){return void 0===t?void 0:t.toString(10)+V.format(e)}!function(t){function e(t){return!Array.isArray(t)&&null!==t&&"object"==typeof t}t.isJson=function(t){return e(t)},t.isJsonObject=e}(D||(D={})),(h=R||(R={})).ground="ground",h.row="row",h.column="column",h.stack="stack",h.component="component",(d=U||(U={})).none="none",d.always="always",d.onload="onload",(m=V||(V={})).Pixel="px",m.Percent="%",m.Fractional="fr",m.Em="em",(c=V||(V={})).tryParse=function(t){switch(t){case c.Pixel:return c.Pixel;case c.Percent:return c.Percent;case c.Fractional:return c.Fractional;case c.Em:return c.Em;default:return}},c.format=function(t){switch(t){case c.Pixel:return c.Pixel;case c.Percent:return c.Percent;case c.Fractional:return c.Fractional;case c.Em:return c.Em;default:throw new tQ("SUEF44998",t)}},function(t){let e=["settings","hasHeaders","constrainDragToContainer","selectionEnabled","dimensions","borderWidth","minItemHeight","minItemWidth","headerHeight","dragProxyWidth","dragProxyHeight","labels","close","maximise","minimise","popout","content","componentType","componentState","id","width","type","height","isClosable","title","popoutWholeStack","openPopouts","parentId","activeItemIndex","reorderEnabled","borderGrabWidth"],i=[!0,!1,"row","column","stack","component","close","maximise","minimise","open in new window"];t.checkInitialise=function(){if(e.length>36)throw Error("Too many keys in config minifier map")},t.translateObject=function t(n,o){let s={};for(let r in n)if(n.hasOwnProperty(r)){let a;a=o?function(t){if("string"==typeof t&&1===t.length)return"___"+t;let i=function(t){for(let i=0;i<e.length;i++)if(e[i]===t)return i;return -1}(t);return -1===i?t:i.toString(36)}(r):1===r.length?e[parseInt(r,36)]:"___"===r.substr(0,3)?r[3]:r;let l=n[r];s[a]=function e(n,o){return"object"==typeof n?null===n?null:Array.isArray(n)?function(t,i){let n=t.length,o=Array(n);for(let s=0;s<n;s++){let n=t[s];o[s]=e(n,i)}return o}(n,o):t(n,o):o?function(t){if("string"==typeof t&&1===t.length)return"___"+t;let e=function(t){for(let e=0;e<i.length;e++)if(i[e]===t)return e;return -1}(t);return -1===e?t:e.toString(36)}(n):"string"==typeof n&&1===n.length?i[parseInt(n,36)]:"string"==typeof n&&"___"===n.substr(0,3)?n[3]:n}(l,o)}return s}}(O||(O={})),(u=B||(B={})).defaults={type:R.ground,content:[],size:1,sizeUnit:V.Fractional,minSize:void 0,minSizeUnit:V.Pixel,id:"",isClosable:!0},u.createCopy=function(t,e){switch(t.type){case R.ground:case R.row:case R.column:return N.createCopy(t,e);case R.stack:return H.createCopy(t,e);case R.component:return F.createCopy(t);default:throw new tQ("CICC91354",t.type,"Invalid Config Item type specified")}},u.createDefault=function(t){switch(t){case R.ground:throw new tJ("CICCDR91562");case R.row:case R.column:return N.createDefault(t);case R.stack:return H.createDefault();case R.component:return F.createDefault();default:throw new tQ("CICCDD91563",t,"Invalid Config Item type specified")}},u.isComponentItem=function(t){return t.type===R.component},u.isStackItem=function(t){return t.type===R.stack},u.isGroundItem=function(t){return t.type===R.ground},(p=W||(W={})).defaultMaximised=!1,(p.Header||(p.Header={})).createCopy=function(t,e){return void 0===t?void 0:{show:null!=e?e:t.show,popout:t.popout,close:t.close,maximise:t.maximise,minimise:t.minimise,tabDropdown:t.tabDropdown}},function(t){function e(t){let e=t.length,i=Array(e);for(let n=0;n<e;n++)i[n]=B.createCopy(t[n]);return i}t.defaultActiveItemIndex=0,t.createCopy=function(t,i){return{type:t.type,content:e(void 0!==i?i:t.content),size:t.size,sizeUnit:t.sizeUnit,minSize:t.minSize,minSizeUnit:t.minSizeUnit,id:t.id,maximised:t.maximised,isClosable:t.isClosable,activeItemIndex:t.activeItemIndex,header:W.Header.createCopy(t.header)}},t.copyContent=e,t.createDefault=function(){return{type:R.stack,content:[],size:B.defaults.size,sizeUnit:B.defaults.sizeUnit,minSize:B.defaults.minSize,minSizeUnit:B.defaults.minSizeUnit,id:B.defaults.id,maximised:W.defaultMaximised,isClosable:B.defaults.isClosable,activeItemIndex:t.defaultActiveItemIndex,header:void 0}}}(H||(H={})),(g=F||(F={})).defaultReorderEnabled=!0,g.resolveComponentTypeName=function(t){let e=t.componentType;return"string"==typeof e?e:void 0},g.createCopy=function(t){return{type:t.type,content:[],size:t.size,sizeUnit:t.sizeUnit,minSize:t.minSize,minSizeUnit:t.minSizeUnit,id:t.id,maximised:t.maximised,isClosable:t.isClosable,reorderEnabled:t.reorderEnabled,title:t.title,header:W.Header.createCopy(t.header),componentType:t.componentType,componentState:ee(void 0,t.componentState)}},g.createDefault=function(t="",e,i=""){return{type:R.component,content:[],size:B.defaults.size,sizeUnit:B.defaults.sizeUnit,minSize:B.defaults.minSize,minSizeUnit:B.defaults.minSizeUnit,id:B.defaults.id,maximised:W.defaultMaximised,isClosable:B.defaults.isClosable,reorderEnabled:g.defaultReorderEnabled,title:i,header:void 0,componentType:t,componentState:e}},g.copyComponentType=function(t){return ee({},t)},function(t){function e(t){let e=t.length,i=Array(e);for(let n=0;n<e;n++)i[n]=B.createCopy(t[n]);return i}t.isChildItemConfig=function(t){switch(t.type){case R.row:case R.column:case R.stack:case R.component:return!0;case R.ground:return!1;default:throw new tQ("CROCOSPCICIC13687",t.type)}},t.createCopy=function(t,i){return{type:t.type,content:e(void 0!==i?i:t.content),size:t.size,sizeUnit:t.sizeUnit,minSize:t.minSize,minSizeUnit:t.minSizeUnit,id:t.id,isClosable:t.isClosable}},t.copyContent=e,t.createDefault=function(t){return{type:t,content:[],size:B.defaults.size,sizeUnit:B.defaults.sizeUnit,minSize:B.defaults.minSize,minSizeUnit:B.defaults.minSizeUnit,id:B.defaults.id,isClosable:B.defaults.isClosable}}}(N||(N={})),(f=$||($={})).createCopy=function(t){return B.createCopy(t)},f.isRootItemConfig=function(t){switch(t.type){case R.row:case R.column:case R.stack:case R.component:return!0;case R.ground:return!1;default:throw new tQ("CROCOSPCICIC13687",t.type)}},(j||(j={})).create=function(t){return{type:R.ground,content:void 0===t?[]:[t],size:100,sizeUnit:V.Percent,minSize:0,minSizeUnit:V.Pixel,id:"",isClosable:!1,title:"",reorderEnabled:!1}},function(t){var e,i,n;function o(t){return"parentId"in t}(e=t.Settings||(t.Settings={})).defaults={constrainDragToContainer:!0,reorderEnabled:!0,popoutWholeStack:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,responsiveMode:U.none,tabOverlapAllowance:0,reorderOnTabMenuClick:!0,tabControlOffset:10,popInOnClose:!1},e.createCopy=function(t){return{constrainDragToContainer:t.constrainDragToContainer,reorderEnabled:t.reorderEnabled,popoutWholeStack:t.popoutWholeStack,blockedPopoutsThrowError:t.blockedPopoutsThrowError,closePopoutsOnUnload:t.closePopoutsOnUnload,responsiveMode:t.responsiveMode,tabOverlapAllowance:t.tabOverlapAllowance,reorderOnTabMenuClick:t.reorderOnTabMenuClick,tabControlOffset:t.tabControlOffset,popInOnClose:t.popInOnClose}},(i=t.Dimensions||(t.Dimensions={})).createCopy=function(t){return{borderWidth:t.borderWidth,borderGrabWidth:t.borderGrabWidth,defaultMinItemHeight:t.defaultMinItemHeight,defaultMinItemHeightUnit:t.defaultMinItemHeightUnit,defaultMinItemWidth:t.defaultMinItemWidth,defaultMinItemWidthUnit:t.defaultMinItemWidthUnit,headerHeight:t.headerHeight,dragProxyWidth:t.dragProxyWidth,dragProxyHeight:t.dragProxyHeight}},i.defaults={borderWidth:5,borderGrabWidth:5,defaultMinItemHeight:0,defaultMinItemHeightUnit:V.Pixel,defaultMinItemWidth:10,defaultMinItemWidthUnit:V.Pixel,headerHeight:20,dragProxyWidth:300,dragProxyHeight:200},(n=t.Header||(t.Header={})).createCopy=function(t){return{show:t.show,popout:t.popout,dock:t.dock,close:t.close,maximise:t.maximise,minimise:t.minimise,tabDropdown:t.tabDropdown}},n.defaults={show:A.top,popout:"open in new window",dock:"dock",maximise:"maximise",minimise:"minimise",close:"close",tabDropdown:"additional tabs"},t.isPopout=o,t.createDefault=function(){return{root:void 0,openPopouts:[],dimensions:t.Dimensions.defaults,settings:t.Settings.defaults,header:t.Header.defaults,resolved:!0}},t.createCopy=function(e){return o(e)?Z.createCopy(e):{root:void 0===e.root?void 0:$.createCopy(e.root),openPopouts:t.copyOpenPopouts(e.openPopouts),settings:t.Settings.createCopy(e.settings),dimensions:t.Dimensions.createCopy(e.dimensions),header:t.Header.createCopy(e.header),resolved:e.resolved}},t.copyOpenPopouts=function(t){let e=t.length,i=Array(e);for(let n=0;n<e;n++)i[n]=Z.createCopy(t[n]);return i},t.minifyConfig=function(t){return O.translateObject(t,!0)},t.unminifyConfig=function(t){return O.translateObject(t,!1)}}(G||(G={})),(_=(v=Z||(Z={})).Window||(v.Window={})).createCopy=function(t){return{width:t.width,height:t.height,left:t.left,top:t.top}},_.defaults={width:null,height:null,left:null,top:null},v.createCopy=function(t){return{root:void 0===t.root?void 0:$.createCopy(t.root),openPopouts:G.copyOpenPopouts(t.openPopouts),settings:G.Settings.createCopy(t.settings),dimensions:G.Dimensions.createCopy(t.dimensions),header:G.Header.createCopy(t.header),parentId:t.parentId,indexInParent:t.indexInParent,window:v.Window.createCopy(t.window),resolved:t.resolved}},(y=q||(q={})).resolve=function(t,e){switch(t.type){case R.ground:throw new tZ("ItemConfig cannot specify type ground",JSON.stringify(t));case R.row:case R.column:return J.resolve(t,e);case R.stack:return Y.resolve(t,e);case R.component:return K.resolve(t,e);default:throw new tQ("UCUICR55499",t.type)}},y.resolveContent=function(t){if(void 0===t)return[];{let e=t.length,i=Array(e);for(let n=0;n<e;n++)i[n]=y.resolve(t[n],!1);return i}},y.resolveId=function(t){return void 0===t?B.defaults.id:Array.isArray(t)?0===t.length?B.defaults.id:t[0]:t},y.resolveSize=function(t,e,i,n){if(void 0!==t)return en(t,[V.Percent,V.Fractional]);if(void 0!==e||void 0!==i){if(void 0!==e)return{size:e,sizeUnit:V.Percent};if(void 0!==i)return{size:i,sizeUnit:V.Percent};throw new t1("CRS33390")}return n?{size:50,sizeUnit:V.Percent}:{size:B.defaults.size,sizeUnit:B.defaults.sizeUnit}},y.resolveMinSize=function(t,e,i){if(void 0!==t)return en(t,[V.Pixel]);{let t=void 0!==e;return t||void 0!==i?t?{size:e,sizeUnit:V.Pixel}:{size:i,sizeUnit:V.Pixel}:{size:B.defaults.minSize,sizeUnit:B.defaults.minSizeUnit}}},y.calculateSizeWidthHeightSpecificationType=function(t){return void 0!==t.size?1:void 0!==t.width||void 0!==t.height?2:0},y.isGround=function(t){return t.type===R.ground},y.isRow=function(t){return t.type===R.row},y.isColumn=function(t){return t.type===R.column},y.isStack=function(t){return t.type===R.stack},y.isComponent=function(t){return t.type===R.component},((C=X||(X={})).Header||(C.Header={})).resolve=function(t,e){var i;if(void 0!==t||void 0!==e)return{show:null!==(i=null==t?void 0:t.show)&&void 0!==i?i:void 0===e?void 0:!!e&&G.Header.defaults.show,popout:null==t?void 0:t.popout,maximise:null==t?void 0:t.maximise,close:null==t?void 0:t.close,minimise:null==t?void 0:t.minimise,tabDropdown:null==t?void 0:t.tabDropdown}},C.resolveIdAndMaximised=function(t){let e,i=t.id,n=!1;if(void 0===i)e=B.defaults.id;else if(Array.isArray(i)){let t=i.findIndex(t=>"__glMaximised"===t);t>0&&(n=!0,i=i.splice(t,1)),e=i.length>0?i[0]:B.defaults.id}else e=i;return{id:e,maximised:void 0!==t.maximised?t.maximised:n}},(w=Y||(Y={})).resolve=function(t,e){var i,n;let{id:o,maximised:s}=X.resolveIdAndMaximised(t),{size:r,sizeUnit:a}=q.resolveSize(t.size,t.width,t.height,e),{size:l,sizeUnit:h}=q.resolveMinSize(t.minSize,t.minWidth,t.minHeight);return{type:R.stack,content:function(t){if(void 0===t)return[];{let e=t.length,i=Array(e);for(let n=0;n<e;n++){let e=t[n],o=q.resolve(e,!1);if(!B.isComponentItem(o))throw new tJ("UCUSICRC91114",JSON.stringify(o));i[n]=o}return i}}(t.content),size:r,sizeUnit:a,minSize:l,minSizeUnit:h,id:o,maximised:s,isClosable:null!==(i=t.isClosable)&&void 0!==i?i:B.defaults.isClosable,activeItemIndex:null!==(n=t.activeItemIndex)&&void 0!==n?n:H.defaultActiveItemIndex,header:X.Header.resolve(t.header,t.hasHeaders)}},w.fromResolved=function(t){return{type:R.stack,content:function(t){let e=t.length,i=Array(e);for(let n=0;n<e;n++){let e=t[n];i[n]=K.fromResolved(e)}return i}(t.content),size:eo(t.size,t.sizeUnit),minSize:es(t.minSize,t.minSizeUnit),id:t.id,maximised:t.maximised,isClosable:t.isClosable,activeItemIndex:t.activeItemIndex,header:W.Header.createCopy(t.header)}},(I=K||(K={})).resolve=function(t,e){var i,n,o;let s=t.componentType;if(void 0===s&&(s=t.componentName),void 0===s)throw Error("ComponentItemConfig.componentType is undefined");{let r;let{id:a,maximised:l}=X.resolveIdAndMaximised(t);r=void 0===t.title||""===t.title?I.componentTypeToTitle(s):t.title;let{size:h,sizeUnit:d}=q.resolveSize(t.size,t.width,t.height,e),{size:m,sizeUnit:c}=q.resolveMinSize(t.minSize,t.minWidth,t.minHeight);return{type:t.type,content:[],size:h,sizeUnit:d,minSize:m,minSizeUnit:c,id:a,maximised:l,isClosable:null!==(i=t.isClosable)&&void 0!==i?i:B.defaults.isClosable,reorderEnabled:null!==(n=t.reorderEnabled)&&void 0!==n?n:F.defaultReorderEnabled,title:r,header:X.Header.resolve(t.header,t.hasHeaders),componentType:s,componentState:null!==(o=t.componentState)&&void 0!==o?o:{}}}},I.fromResolved=function(t){return{type:R.component,size:eo(t.size,t.sizeUnit),minSize:es(t.minSize,t.minSizeUnit),id:t.id,maximised:t.maximised,isClosable:t.isClosable,reorderEnabled:t.reorderEnabled,title:t.title,header:W.Header.createCopy(t.header),componentType:t.componentType,componentState:ee(void 0,t.componentState)}},I.componentTypeToTitle=function(t){switch(typeof t){case"string":return t;case"number":case"boolean":return t.toString();default:return""}},(b=J||(J={})).isChildItemConfig=function(t){switch(t.type){case R.row:case R.column:case R.stack:case R.component:return!0;case R.ground:return!1;default:throw new tQ("UROCOSPCICIC13687",t.type)}},b.resolve=function(t,e){var i;let{size:n,sizeUnit:o}=q.resolveSize(t.size,t.width,t.height,e),{size:s,sizeUnit:r}=q.resolveMinSize(t.minSize,t.minWidth,t.minHeight);return{type:t.type,content:b.resolveContent(t.content),size:n,sizeUnit:o,minSize:s,minSizeUnit:r,id:q.resolveId(t.id),isClosable:null!==(i=t.isClosable)&&void 0!==i?i:B.defaults.isClosable}},b.fromResolved=function(t){return{type:t.type,content:function(t){let e=t.length,i=Array(e);for(let n=0;n<e;n++){let e;let o=t[n],s=o.type;switch(s){case R.row:case R.column:e=b.fromResolved(o);break;case R.stack:e=Y.fromResolved(o);break;case R.component:e=K.fromResolved(o);break;default:throw new tQ("ROCICFRC44797",s)}i[n]=e}return i}(t.content),size:eo(t.size,t.sizeUnit),minSize:es(t.minSize,t.minSizeUnit),id:t.id,isClosable:t.isClosable}},b.resolveContent=function(t){if(void 0===t)return[];{let e=t.length,i=Array(e),n,o=!1,s=!1;for(let n=0;n<e;n++){let e=t[n];if(!b.isChildItemConfig(e))throw new tZ("ItemConfig is not Row, Column or Stack",e);if(!s){let t=q.calculateSizeWidthHeightSpecificationType(e);switch(t){case 0:break;case 2:o=!0;break;case 1:s=!0;break;default:throw new tQ("ROCICRC87556",t)}}i[n]=e}n=!s&&!!o;let r=Array(e);for(let t=0;t<e;t++){let e=i[t],o=q.resolve(e,n);if(!N.isChildItemConfig(o))throw new tJ("UROCOSPIC99512",JSON.stringify(o));r[t]=o}return r}},(S=Q||(Q={})).isRootItemConfig=function(t){switch(t.type){case R.row:case R.column:case R.stack:case R.component:return!0;case R.ground:return!1;default:throw new tQ("URICIR23687",t.type)}},S.resolve=function(t){if(void 0!==t){let e=q.resolve(t,!1);if($.isRootItemConfig(e))return e;throw new tZ("ItemConfig is not Row, Column or Stack",JSON.stringify(t))}},S.fromResolvedOrUndefined=function(t){if(void 0!==t){let e=t.type;switch(e){case R.row:case R.column:return J.fromResolved(t);case R.stack:return Y.fromResolved(t);case R.component:return K.fromResolved(t);default:throw new tQ("RICFROU89921",e)}}},function(t){var e;function i(t){return"parentId"in t||"indexInParent"in t||"window"in t}(t.Settings||(t.Settings={})).resolve=function(t){var e,i,n,o,s,r,a,l,h,d;return{constrainDragToContainer:null!==(e=null==t?void 0:t.constrainDragToContainer)&&void 0!==e?e:G.Settings.defaults.constrainDragToContainer,reorderEnabled:null!==(i=null==t?void 0:t.reorderEnabled)&&void 0!==i?i:G.Settings.defaults.reorderEnabled,popoutWholeStack:null!==(n=null==t?void 0:t.popoutWholeStack)&&void 0!==n?n:G.Settings.defaults.popoutWholeStack,blockedPopoutsThrowError:null!==(o=null==t?void 0:t.blockedPopoutsThrowError)&&void 0!==o?o:G.Settings.defaults.blockedPopoutsThrowError,closePopoutsOnUnload:null!==(s=null==t?void 0:t.closePopoutsOnUnload)&&void 0!==s?s:G.Settings.defaults.closePopoutsOnUnload,responsiveMode:null!==(r=null==t?void 0:t.responsiveMode)&&void 0!==r?r:G.Settings.defaults.responsiveMode,tabOverlapAllowance:null!==(a=null==t?void 0:t.tabOverlapAllowance)&&void 0!==a?a:G.Settings.defaults.tabOverlapAllowance,reorderOnTabMenuClick:null!==(l=null==t?void 0:t.reorderOnTabMenuClick)&&void 0!==l?l:G.Settings.defaults.reorderOnTabMenuClick,tabControlOffset:null!==(h=null==t?void 0:t.tabControlOffset)&&void 0!==h?h:G.Settings.defaults.tabControlOffset,popInOnClose:null!==(d=null==t?void 0:t.popInOnClose)&&void 0!==d?d:G.Settings.defaults.popInOnClose}},(e=t.Dimensions||(t.Dimensions={})).resolve=function(t){var i,n,o,s,r;let{size:a,sizeUnit:l}=e.resolveDefaultMinItemHeight(t),{size:h,sizeUnit:d}=e.resolveDefaultMinItemWidth(t);return{borderWidth:null!==(i=null==t?void 0:t.borderWidth)&&void 0!==i?i:G.Dimensions.defaults.borderWidth,borderGrabWidth:null!==(n=null==t?void 0:t.borderGrabWidth)&&void 0!==n?n:G.Dimensions.defaults.borderGrabWidth,defaultMinItemHeight:a,defaultMinItemHeightUnit:l,defaultMinItemWidth:h,defaultMinItemWidthUnit:d,headerHeight:null!==(o=null==t?void 0:t.headerHeight)&&void 0!==o?o:G.Dimensions.defaults.headerHeight,dragProxyWidth:null!==(s=null==t?void 0:t.dragProxyWidth)&&void 0!==s?s:G.Dimensions.defaults.dragProxyWidth,dragProxyHeight:null!==(r=null==t?void 0:t.dragProxyHeight)&&void 0!==r?r:G.Dimensions.defaults.dragProxyHeight}},e.fromResolved=function(t){return{borderWidth:t.borderWidth,borderGrabWidth:t.borderGrabWidth,defaultMinItemHeight:eo(t.defaultMinItemHeight,t.defaultMinItemHeightUnit),defaultMinItemWidth:eo(t.defaultMinItemWidth,t.defaultMinItemWidthUnit),headerHeight:t.headerHeight,dragProxyWidth:t.dragProxyWidth,dragProxyHeight:t.dragProxyHeight}},e.resolveDefaultMinItemHeight=function(t){let e=null==t?void 0:t.defaultMinItemHeight;return void 0===e?{size:G.Dimensions.defaults.defaultMinItemHeight,sizeUnit:G.Dimensions.defaults.defaultMinItemHeightUnit}:en(e,[V.Pixel])},e.resolveDefaultMinItemWidth=function(t){let e=null==t?void 0:t.defaultMinItemWidth;return void 0===e?{size:G.Dimensions.defaults.defaultMinItemWidth,sizeUnit:G.Dimensions.defaults.defaultMinItemWidthUnit}:en(e,[V.Pixel])},(t.Header||(t.Header={})).resolve=function(t,e,i){var n,o,s,r,a,l,h,d,m,c,u,p;return{show:void 0!==(null==t?void 0:t.show)?t.show:void 0!==e&&void 0!==e.hasHeaders?!!e.hasHeaders&&G.Header.defaults.show:G.Header.defaults.show,popout:null!==(o=null!==(n=null==t?void 0:t.popout)&&void 0!==n?n:null==i?void 0:i.popout)&&void 0!==o?o:!1!==(null==e?void 0:e.showPopoutIcon)&&G.Header.defaults.popout,dock:null!==(r=null!==(s=null==t?void 0:t.popin)&&void 0!==s?s:null==i?void 0:i.popin)&&void 0!==r?r:G.Header.defaults.dock,maximise:null!==(l=null!==(a=null==t?void 0:t.maximise)&&void 0!==a?a:null==i?void 0:i.maximise)&&void 0!==l?l:!1!==(null==e?void 0:e.showMaximiseIcon)&&G.Header.defaults.maximise,close:null!==(d=null!==(h=null==t?void 0:t.close)&&void 0!==h?h:null==i?void 0:i.close)&&void 0!==d?d:!1!==(null==e?void 0:e.showCloseIcon)&&G.Header.defaults.close,minimise:null!==(c=null!==(m=null==t?void 0:t.minimise)&&void 0!==m?m:null==i?void 0:i.minimise)&&void 0!==c?c:G.Header.defaults.minimise,tabDropdown:null!==(p=null!==(u=null==t?void 0:t.tabDropdown)&&void 0!==u?u:null==i?void 0:i.tabDropdown)&&void 0!==p?p:G.Header.defaults.tabDropdown}},t.isPopout=i,t.resolve=function(e){if(i(e))return te.resolve(e);{let i;return i=void 0!==e.root?e.root:void 0!==e.content&&e.content.length>0?e.content[0]:void 0,{resolved:!0,root:Q.resolve(i),openPopouts:t.resolveOpenPopouts(e.openPopouts),dimensions:t.Dimensions.resolve(e.dimensions),settings:t.Settings.resolve(e.settings),header:t.Header.resolve(e.header,e.settings,e.labels)}}},t.fromResolved=function(e){return{root:Q.fromResolvedOrUndefined(e.root),openPopouts:te.fromResolvedArray(e.openPopouts),settings:G.Settings.createCopy(e.settings),dimensions:t.Dimensions.fromResolved(e.dimensions),header:G.Header.createCopy(e.header)}},t.isResolved=function(t){return void 0!==t.resolved&&!0===t.resolved},t.resolveOpenPopouts=function(t){if(void 0===t)return[];{let e=t.length,i=Array(e);for(let n=0;n<e;n++)i[n]=te.resolve(t[n]);return i}}}(tt||(tt={})),function(t){var e;function i(e){let i=e.length,n=Array(i);for(let o=0;o<i;o++){let i=e[o];n[o]=t.fromResolved(i)}return n}(e=t.Window||(t.Window={})).resolve=function(t,e){var i,n,o,s,r,a,l,h;let d=Z.Window.defaults;return void 0!==t?{width:null!==(i=t.width)&&void 0!==i?i:d.width,height:null!==(n=t.height)&&void 0!==n?n:d.height,left:null!==(o=t.left)&&void 0!==o?o:d.left,top:null!==(s=t.top)&&void 0!==s?s:d.top}:{width:null!==(r=null==e?void 0:e.width)&&void 0!==r?r:d.width,height:null!==(a=null==e?void 0:e.height)&&void 0!==a?a:d.height,left:null!==(l=null==e?void 0:e.left)&&void 0!==l?l:d.left,top:null!==(h=null==e?void 0:e.top)&&void 0!==h?h:d.top}},e.fromResolved=function(t){return{width:null===t.width?void 0:t.width,height:null===t.height?void 0:t.height,left:null===t.left?void 0:t.left,top:null===t.top?void 0:t.top}},t.resolve=function(e){var i,n;let o;return o=void 0!==e.root?e.root:void 0!==e.content&&e.content.length>0?e.content[0]:void 0,{root:Q.resolve(o),openPopouts:tt.resolveOpenPopouts(e.openPopouts),dimensions:tt.Dimensions.resolve(e.dimensions),settings:tt.Settings.resolve(e.settings),header:tt.Header.resolve(e.header,e.settings,e.labels),parentId:null!==(i=e.parentId)&&void 0!==i?i:null,indexInParent:null!==(n=e.indexInParent)&&void 0!==n?n:null,window:t.Window.resolve(e.window,e.dimensions),resolved:!0}},t.fromResolved=function(e){return{root:Q.fromResolvedOrUndefined(e.root),openPopouts:i(e.openPopouts),dimensions:tt.Dimensions.fromResolved(e.dimensions),settings:G.Settings.createCopy(e.settings),header:G.Header.createCopy(e.header),parentId:e.parentId,indexInParent:e.indexInParent,window:t.Window.fromResolved(e.window)}},t.fromResolvedArray=i}(te||(te={}));class er{constructor(){this._allEventSubscriptions=[],this._subscriptionsMap=new Map,this.unbind=this.removeEventListener,this.trigger=this.emit}tryBubbleEvent(t,e){}emit(t,...e){let i=this._subscriptionsMap.get(t);if(void 0!==i){i=i.slice();for(let t=0;t<i.length;t++)(0,i[t])(...e)}this.emitAllEvent(t,e),this.tryBubbleEvent(t,e)}emitUnknown(t,...e){let i=this._subscriptionsMap.get(t);if(void 0!==i){i=i.slice();for(let t=0;t<i.length;t++)i[t](...e)}this.emitAllEvent(t,e),this.tryBubbleEvent(t,e)}emitBaseBubblingEvent(t){let e=new er.BubblingEvent(t,this);this.emitUnknown(t,e)}emitUnknownBubblingEvent(t){let e=new er.BubblingEvent(t,this);this.emitUnknown(t,e)}removeEventListener(t,e){this.removeUnknownEventListener(t,e)}off(t,e){this.removeEventListener(t,e)}addEventListener(t,e){this.addUnknownEventListener(t,e)}on(t,e){this.addEventListener(t,e)}addUnknownEventListener(t,e){if(t===er.ALL_EVENT)this._allEventSubscriptions.push(e);else{let i=this._subscriptionsMap.get(t);void 0!==i?i.push(e):(i=[e],this._subscriptionsMap.set(t,i))}}removeUnknownEventListener(t,e){if(t===er.ALL_EVENT)this.removeSubscription(t,this._allEventSubscriptions,e);else{let i=this._subscriptionsMap.get(t);if(void 0===i)throw Error("No subscribtions to unsubscribe for event "+t);this.removeSubscription(t,i,e)}}removeSubscription(t,e,i){let n=e.indexOf(i);if(n<0)throw Error("Nothing to unbind for "+t);e.splice(n,1)}emitAllEvent(t,e){let i=this._allEventSubscriptions.length;if(i>0){let n=e.slice();n.unshift(t);let o=this._allEventSubscriptions.slice();for(let t=0;t<i;t++)o[t](...n)}}}!function(t){t.ALL_EVENT="__all",t.headerClickEventName="stackHeaderClick",t.headerTouchStartEventName="stackHeaderTouchStart";class e{constructor(t,e){this._name=t,this._target=e,this._isPropagationStopped=!1}get name(){return this._name}get target(){return this._target}get origin(){return this._target}get isPropagationStopped(){return this._isPropagationStopped}stopPropagation(){this._isPropagationStopped=!0}}t.BubblingEvent=e,t.ClickBubblingEvent=class extends e{constructor(t,e,i){super(t,e),this._mouseEvent=i}get mouseEvent(){return this._mouseEvent}},t.TouchStartBubblingEvent=class extends e{constructor(t,e,i){super(t,e),this._touchEvent=i}get touchEvent(){return this._touchEvent}}}(er||(er={}));class ea extends er{constructor(t,e,i,n,o,s,r,a,l){super(),this._config=t,this._parent=e,this._layoutManager=i,this._element=n,this._updateItemConfigEvent=o,this._showEvent=s,this._hideEvent=r,this._focusEvent=a,this._blurEvent=l,this._stackMaximised=!1,this._width=0,this._height=0,this._visible=!0,this._isShownWithZeroDimensions=!0,this._componentType=t.componentType,this._isClosable=t.isClosable,this._initialState=t.componentState,this._state=this._initialState,this._boundComponent=this.layoutManager.bindComponent(this,t),this.updateElementPositionPropertyFromBoundComponent()}get width(){return this._width}get height(){return this._height}get parent(){return this._parent}get componentName(){return this._componentType}get componentType(){return this._componentType}get virtual(){return this._boundComponent.virtual}get component(){return this._boundComponent.component}get tab(){return this._tab}get title(){return this._parent.title}get layoutManager(){return this._layoutManager}get isHidden(){return!this._visible}get visible(){return this._visible}get state(){return this._state}get initialState(){return this._initialState}get element(){return this._element}destroy(){this.releaseComponent(),this.stateRequestEvent=void 0,this.emit("destroy")}getElement(){return this._element}hide(){this._hideEvent()}show(){this._showEvent()}focus(t=!1){this._focusEvent(t)}blur(t=!1){this._blurEvent(t)}setSize(t,e){let i=this._parent;if(i.isColumn||i.isRow||null===i.parent)throw new tJ("ICSSPRC","ComponentContainer cannot have RowColumn Parent");{let n;do n=i,i=i.parent;while(null!==i&&!i.isColumn&&!i.isRow);if(null===i)return!1;{let o=i.isColumn?"height":"width",s=this[o];if(null===s)throw new t0("ICSSCS11194");{let r=("height"===o?e:t)/(1/(n.size/100)*s)*100,a=(n.size-r)/(i.contentItems.length-1);for(let t=0;t<i.contentItems.length;t++){let e=i.contentItems[t];e===n?e.size=r:e.size+=a}return i.updateSize(!1),!0}}}}close(){this._isClosable&&(this.emit("close"),this._parent.close())}replaceComponent(t){if(this.releaseComponent(),!q.isComponent(t))throw Error("ReplaceComponent not passed a component ItemConfig");{let e=K.resolve(t,!1);if(this._initialState=e.componentState,this._state=this._initialState,this._componentType=e.componentType,this._updateItemConfigEvent(e),this._boundComponent=this.layoutManager.bindComponent(this,e),this.updateElementPositionPropertyFromBoundComponent(),this._boundComponent.virtual){if(void 0!==this.virtualVisibilityChangeRequiredEvent&&this.virtualVisibilityChangeRequiredEvent(this,this._visible),void 0!==this.virtualRectingRequiredEvent){this._layoutManager.fireBeforeVirtualRectingEvent(1);try{this.virtualRectingRequiredEvent(this,this._width,this._height)}finally{this._layoutManager.fireAfterVirtualRectingEvent()}}this.setBaseLogicalZIndex()}this.emit("stateChanged")}}getState(){return this._state}extendState(t){let e=et(this._state,t);this.setState(e)}setState(t){this._state=t,this._parent.emitBaseBubblingEvent("stateChanged")}setTitle(t){this._parent.setTitle(t)}setTab(t){this._tab=t,this.emit("tab",t)}setVisibility(t){this._boundComponent.virtual&&void 0!==this.virtualVisibilityChangeRequiredEvent&&this.virtualVisibilityChangeRequiredEvent(this,t),t?this._visible?this._isShownWithZeroDimensions&&(0!==this._height||0!==this._width)&&(this._isShownWithZeroDimensions=!1,this.setSizeToNodeSize(this._width,this._height,!0),this.emitShow()):(this._visible=!0,0===this._height&&0===this._width?this._isShownWithZeroDimensions=!0:(this._isShownWithZeroDimensions=!1,this.setSizeToNodeSize(this._width,this._height,!0),this.emitShow())):this._visible&&(this._visible=!1,this._isShownWithZeroDimensions=!1,this.emitHide())}setBaseLogicalZIndex(){this.setLogicalZIndex(k.base)}setLogicalZIndex(t){t!==this._logicalZIndex&&(this._logicalZIndex=t,this.notifyVirtualZIndexChangeRequired())}enterDragMode(t,e){this._width=t,this._height=e,t7(this._element,t),t8(this._element,e),this.setLogicalZIndex(k.drag),this.drag()}exitDragMode(){this.setBaseLogicalZIndex()}enterStackMaximised(){this._stackMaximised=!0,this.setLogicalZIndex(k.stackMaximised)}exitStackMaximised(){this.setBaseLogicalZIndex(),this._stackMaximised=!1}drag(){if(this._boundComponent.virtual&&void 0!==this.virtualRectingRequiredEvent){this._layoutManager.fireBeforeVirtualRectingEvent(1);try{this.virtualRectingRequiredEvent(this,this._width,this._height)}finally{this._layoutManager.fireAfterVirtualRectingEvent()}}}setSizeToNodeSize(t,e,i){(t!==this._width||e!==this._height||i)&&(this._width=t,this._height=e,t7(this._element,t),t8(this._element,e),this._boundComponent.virtual?this.addVirtualSizedContainerToLayoutManager():(this.emit("resize"),this.checkShownFromZeroDimensions()))}notifyVirtualRectingRequired(){void 0!==this.virtualRectingRequiredEvent&&(this.virtualRectingRequiredEvent(this,this._width,this._height),this.emit("resize"),this.checkShownFromZeroDimensions())}notifyVirtualZIndexChangeRequired(){if(void 0!==this.virtualZIndexChangeRequiredEvent){let t=this._logicalZIndex,e=t3[t];this.virtualZIndexChangeRequiredEvent(this,t,e)}}updateElementPositionPropertyFromBoundComponent(){this._boundComponent.virtual?this._element.style.position="static":this._element.style.position=""}addVirtualSizedContainerToLayoutManager(){this._layoutManager.beginVirtualSizedContainerAdding();try{this._layoutManager.addVirtualSizedContainer(this)}finally{this._layoutManager.endVirtualSizedContainerAdding()}}checkShownFromZeroDimensions(){this._isShownWithZeroDimensions&&(0!==this._height||0!==this._width)&&(this._isShownWithZeroDimensions=!1,this.emitShow())}emitShow(){this.emit("shown"),this.emit("show")}emitHide(){this.emit("hide")}releaseComponent(){this._stackMaximised&&this.exitStackMaximised(),this.emit("beforeComponentRelease",this._boundComponent.component),this.layoutManager.unbindComponent(this,this._boundComponent.virtual,this._boundComponent.component)}}class el extends er{constructor(t,e,i){super(),this._config=t,this._initialWindowSize=e,this._layoutManager=i,this._isInitialised=!1,this._popoutWindow=null,this.createWindow()}toConfig(){var t,e;let i,n;if(!1===this._isInitialised)throw Error("Can't create config, layout not yet initialised");let o=this.getGlInstance().saveLayout();null===this._popoutWindow?(i=null,n=null):(i=null!==(t=this._popoutWindow.screenX)&&void 0!==t?t:this._popoutWindow.screenLeft,n=null!==(e=this._popoutWindow.screenY)&&void 0!==e?e:this._popoutWindow.screenTop);let s={width:this.getGlInstance().width,height:this.getGlInstance().height,left:i,top:n};return{root:o.root,openPopouts:o.openPopouts,settings:o.settings,dimensions:o.dimensions,header:o.header,window:s,parentId:this._config.parentId,indexInParent:this._config.indexInParent,resolved:!0}}getGlInstance(){if(null===this._popoutWindow)throw new t0("BPGGI24693");return this._popoutWindow.__glInstance}getWindow(){if(null===this._popoutWindow)throw new t0("BPGW087215");return this._popoutWindow}close(){if(this.getGlInstance())this.getGlInstance().closeWindow();else try{this.getWindow().close()}catch(t){}}popIn(){let t,e=this._config.indexInParent;if(!this._config.parentId)return;let i=et({},this.getGlInstance().saveLayout()).root;if(void 0===i)throw new t1("BPPIR19998");let n=this._layoutManager.groundItem;if(void 0===n)throw new t1("BPPIG34972");(t=n.getItemsByPopInParentId(this._config.parentId)[0])||(t=n.contentItems.length>0?n.contentItems[0]:n,e=0);let o=this._layoutManager.createAndInitContentItem(i,t);t.addChild(o,e),this._layoutManager.layoutConfig.settings.popInOnClose?this._onClose():this.close()}createWindow(){let t=this.createUrl(),e=Math.floor(1e6*Math.random()).toString(36),i=this.serializeWindowFeatures({width:this._initialWindowSize.width,height:this._initialWindowSize.height,innerWidth:this._initialWindowSize.width,innerHeight:this._initialWindowSize.height,menubar:"no",toolbar:"no",location:"no",personalbar:"no",resizable:"yes",scrollbars:"no",status:"no"});if(this._popoutWindow=globalThis.open(t,e,i),this._popoutWindow)this._popoutWindow.addEventListener("load",()=>this.positionWindow(),{passive:!0}),this._popoutWindow.addEventListener("beforeunload",()=>{this._layoutManager.layoutConfig.settings.popInOnClose?this.popIn():this._onClose()},{passive:!0}),this._checkReadyInterval=setInterval(()=>this.checkReady(),10);else if(!0===this._layoutManager.layoutConfig.settings.blockedPopoutsThrowError)throw new tq("Popout blocked")}checkReady(){if(null===this._popoutWindow)throw new t0("BPCR01844");this._popoutWindow.__glInstance&&this._popoutWindow.__glInstance.isInitialised&&(this.onInitialised(),void 0!==this._checkReadyInterval&&(clearInterval(this._checkReadyInterval),this._checkReadyInterval=void 0))}serializeWindowFeatures(t){let e=[];for(let i in t)e.push(i+"="+t[i].toString());return e.join(",")}createUrl(){let t="gl-window-config-"+ei(),e=G.minifyConfig(this._config);try{localStorage.setItem(t,JSON.stringify(e))}catch(t){throw Error("Error while writing to localStorage "+(t instanceof Error?t.message:"string"==typeof t?t:"Unknown Error"))}let i=new URL(location.href);return i.searchParams.set("gl-window",t),i.toString()}positionWindow(){if(null===this._popoutWindow)throw Error("BrowserPopout.positionWindow: null popoutWindow");this._popoutWindow.moveTo(this._initialWindowSize.left,this._initialWindowSize.top),this._popoutWindow.focus()}onInitialised(){this._isInitialised=!0,this.getGlInstance().on("popIn",()=>this.popIn()),this.emit("initialised")}_onClose(){setTimeout(()=>this.emit("closed"),50)}}class eh extends er{constructor(t,e,i,n){super(),this.layoutManager=t,this._parent=i,this._element=n,this._popInParentIds=[],this._type=e.type,this._id=e.id,this._isInitialised=!1,this.isGround=!1,this.isRow=!1,this.isColumn=!1,this.isStack=!1,this.isComponent=!1,this.size=e.size,this.sizeUnit=e.sizeUnit,this.minSize=e.minSize,this.minSizeUnit=e.minSizeUnit,this._isClosable=e.isClosable,this._pendingEventPropagations={},this._throttledEvents=["stateChanged"],this._contentItems=this.createContentItems(e.content)}get type(){return this._type}get id(){return this._id}set id(t){this._id=t}get popInParentIds(){return this._popInParentIds}get parent(){return this._parent}get contentItems(){return this._contentItems}get isClosable(){return this._isClosable}get element(){return this._element}get isInitialised(){return this._isInitialised}static isStack(t){return t.isStack}static isComponentItem(t){return t.isComponent}static isComponentParentableItem(t){return t.isStack||t.isGround}removeChild(t,e=!1){let i=this._contentItems.indexOf(t);if(-1===i)throw Error("Can't remove child item. Unknown content item");if(e||this._contentItems[i].destroy(),this._contentItems.splice(i,1),this._contentItems.length>0)this.updateSize(!1);else if(!this.isGround&&!0===this._isClosable){if(null===this._parent)throw new t0("CIUC00874");this._parent.removeChild(this)}}addChild(t,e,i){return null!=e||(e=this._contentItems.length),this._contentItems.splice(e,0,t),t.setParent(this),!0===this._isInitialised&&!1===t._isInitialised&&t.init(),e}replaceChild(t,e,i=!1){let n=this._contentItems.indexOf(t),o=t._element.parentNode;if(-1===n)throw new tJ("CIRCI23232","Can't replace child. oldChild is not child of this");if(null===o)throw new t0("CIRCP23232");if(o.replaceChild(e._element,t._element),!0===i&&(t._parent=null,t.destroy()),this._contentItems[n]=e,e.setParent(this),e.size=t.size,e.sizeUnit=t.sizeUnit,e.minSize=t.minSize,e.minSizeUnit=t.minSizeUnit,null===e._parent)throw new t0("CIRCNC45699");!0===e._parent._isInitialised&&!1===e._isInitialised&&e.init(),this.updateSize(!1)}remove(){if(null===this._parent)throw new t0("CIR11110");this._parent.removeChild(this)}popout(){let t=ei(),e=this.layoutManager.createPopoutFromContentItem(this,void 0,t,void 0);return this.emitBaseBubblingEvent("stateChanged"),e}calculateConfigContent(){let t=this._contentItems,e=t.length,i=Array(e);for(let n=0;n<e;n++){let e=t[n];i[n]=e.toConfig()}return i}highlightDropZone(t,e,i){let n=this.layoutManager.dropTargetIndicator;if(null===n)throw new t0("ACIHDZ5593");n.highlightArea(i,1)}onDrop(t,e){this.addChild(t)}show(){this.layoutManager.beginSizeInvalidation();try{t6(this._element,!0);for(let t=0;t<this._contentItems.length;t++)this._contentItems[t].show()}finally{this.layoutManager.endSizeInvalidation()}}destroy(){for(let t=0;t<this._contentItems.length;t++)this._contentItems[t].destroy();this._contentItems=[],this.emitBaseBubblingEvent("beforeItemDestroyed"),this._element.remove(),this.emitBaseBubblingEvent("itemDestroyed")}getElementArea(t){let e=(t=null!=t?t:this._element).getBoundingClientRect(),i=e.top+document.body.scrollTop,n=e.left+document.body.scrollLeft,o=e.width,s=e.height;return{x1:n,y1:i,x2:n+o,y2:i+s,surface:o*s,contentItem:this}}init(){this._isInitialised=!0,this.emitBaseBubblingEvent("itemCreated"),this.emitUnknownBubblingEvent(this.type+"Created")}setParent(t){this._parent=t}addPopInParentId(t){this.popInParentIds.includes(t)||this.popInParentIds.push(t)}initContentItems(){for(let t=0;t<this._contentItems.length;t++)this._contentItems[t].init()}hide(){this.layoutManager.beginSizeInvalidation();try{t6(this._element,!1)}finally{this.layoutManager.endSizeInvalidation()}}updateContentItemsSize(t){for(let e=0;e<this._contentItems.length;e++)this._contentItems[e].updateSize(t)}createContentItems(t){let e=Array(t.length);for(let i=0;i<t.length;i++)e[i]=this.layoutManager.createContentItem(t[i],this);return e}propagateEvent(t,e){if(1===e.length){let i=e[0];i instanceof er.BubblingEvent&&!1===i.isPropagationStopped&&!0===this._isInitialised&&(!1===this.isGround&&this._parent?this._parent.emitUnknown(t,i):this.scheduleEventPropagationToLayoutManager(t,i))}}tryBubbleEvent(t,e){if(1===e.length){let i=e[0];i instanceof er.BubblingEvent&&!1===i.isPropagationStopped&&!0===this._isInitialised&&(!1===this.isGround&&this._parent?this._parent.emitUnknown(t,i):this.scheduleEventPropagationToLayoutManager(t,i))}}scheduleEventPropagationToLayoutManager(t,e){-1===this._throttledEvents.indexOf(t)?this.layoutManager.emitUnknown(t,e):!0!==this._pendingEventPropagations[t]&&(this._pendingEventPropagations[t]=!0,globalThis.requestAnimationFrame(()=>this.propagateEventToLayoutManager(t,e)))}propagateEventToLayoutManager(t,e){this._pendingEventPropagations[t]=!1,this.layoutManager.emitUnknown(t,e)}}class ed extends eh{constructor(t,e,i){super(t,e,i,document.createElement("div")),this._parentItem=i,this._focused=!1,this.isComponent=!0,this._reorderEnabled=e.reorderEnabled,this.applyUpdatableConfig(e),this._initialWantMaximise=e.maximised;let n=document.createElement("div");n.classList.add("lm_content"),this.element.appendChild(n),this._container=new ea(e,this,t,n,t=>this.handleUpdateItemConfigEvent(t),()=>this.show(),()=>this.hide(),t=>this.focus(t),t=>this.blur(t))}get componentName(){return this._container.componentType}get componentType(){return this._container.componentType}get reorderEnabled(){return this._reorderEnabled}get initialWantMaximise(){return this._initialWantMaximise}get component(){return this._container.component}get container(){return this._container}get parentItem(){return this._parentItem}get headerConfig(){return this._headerConfig}get title(){return this._title}get tab(){return this._tab}get focused(){return this._focused}destroy(){this._container.destroy(),super.destroy()}applyUpdatableConfig(t){this.setTitle(t.title),this._headerConfig=t.header}toConfig(){let t=this._container.stateRequestEvent,e=void 0===t?this._container.state:t();return{type:R.component,content:[],size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,maximised:!1,isClosable:this.isClosable,reorderEnabled:this._reorderEnabled,title:this._title,header:W.Header.createCopy(this._headerConfig),componentType:F.copyComponentType(this.componentType),componentState:e}}close(){if(null===this.parent)throw new t0("CIC68883");this.parent.removeChild(this,!1)}enterDragMode(t,e){t7(this.element,t),t8(this.element,e),this._container.enterDragMode(t,e)}exitDragMode(){this._container.exitDragMode()}enterStackMaximised(){this._container.enterStackMaximised()}exitStackMaximised(){this._container.exitStackMaximised()}drag(){this._container.drag()}updateSize(t){this.updateNodeSize(t)}init(){this.updateNodeSize(!1),super.init(),this._container.emit("open"),this.initContentItems()}setTitle(t){this._title=t,this.emit("titleChanged",t),this.emit("stateChanged")}setTab(t){this._tab=t,this.emit("tab",t),this._container.setTab(t)}hide(){super.hide(),this._container.setVisibility(!1)}show(){super.show(),this._container.setVisibility(!0)}focus(t=!1){this.parentItem.setActiveComponentItem(this,!0,t)}setFocused(t){this._focused=!0,this.tab.setFocused(),t||this.emitBaseBubblingEvent("focus")}blur(t=!1){this._focused&&this.layoutManager.setFocusedComponentItem(void 0,t)}setBlurred(t){this._focused=!1,this.tab.setBlurred(),t||this.emitBaseBubblingEvent("blur")}setParent(t){this._parentItem=t,super.setParent(t)}handleUpdateItemConfigEvent(t){this.applyUpdatableConfig(t)}updateNodeSize(t){if("none"!==this.element.style.display){let{width:e,height:i}=t4(this.element);this._container.setSizeToNodeSize(e,i,t)}}}class em extends eh{constructor(){super(...arguments),this._focused=!1}get focused(){return this._focused}setFocusedValue(t){this._focused=t}}class ec extends er{constructor(t,e){super(),this._eElement=t,this._pointerTracking=!1,this._pointerDownEventListener=t=>this.onPointerDown(t),this._pointerMoveEventListener=t=>this.onPointerMove(t),this._pointerUpEventListener=t=>this.onPointerUp(t),this._timeout=void 0,this._allowableTargets=[t,...e],this._oDocument=document,this._eBody=document.body,this._nDelay=1800,this._nDistance=10,this._nX=0,this._nY=0,this._nOriginalX=0,this._nOriginalY=0,this._dragging=!1,this._eElement.addEventListener("pointerdown",this._pointerDownEventListener,{passive:!0})}destroy(){this.checkRemovePointerTrackingEventListeners(),this._eElement.removeEventListener("pointerdown",this._pointerDownEventListener)}cancelDrag(){this.processDragStop(void 0)}onPointerDown(t){if(this._allowableTargets.includes(t.target)&&t.isPrimary){let e=this.getPointerCoordinates(t);this.processPointerDown(e)}}processPointerDown(t){this._nOriginalX=t.x,this._nOriginalY=t.y,this._oDocument.addEventListener("pointermove",this._pointerMoveEventListener),this._oDocument.addEventListener("pointerup",this._pointerUpEventListener,{passive:!0}),this._pointerTracking=!0,this._timeout=setTimeout(()=>{try{this.startDrag()}catch(t){throw console.error(t),t}},this._nDelay)}onPointerMove(t){this._pointerTracking&&(this.processDragMove(t),t.preventDefault())}processDragMove(t){this._nX=t.pageX-this._nOriginalX,this._nY=t.pageY-this._nOriginalY,!1===this._dragging&&(Math.abs(this._nX)>this._nDistance||Math.abs(this._nY)>this._nDistance)&&this.startDrag(),this._dragging&&this.emit("drag",this._nX,this._nY,t)}onPointerUp(t){this.processDragStop(t)}processDragStop(t){var e;void 0!==this._timeout&&(clearTimeout(this._timeout),this._timeout=void 0),this.checkRemovePointerTrackingEventListeners(),!0===this._dragging&&(this._eBody.classList.remove("lm_dragging"),this._eElement.classList.remove("lm_dragging"),null===(e=this._oDocument.querySelector("iframe"))||void 0===e||e.style.setProperty("pointer-events",""),this._dragging=!1,this.emit("dragStop",t))}checkRemovePointerTrackingEventListeners(){this._pointerTracking&&(this._oDocument.removeEventListener("pointermove",this._pointerMoveEventListener),this._oDocument.removeEventListener("pointerup",this._pointerUpEventListener),this._pointerTracking=!1)}startDrag(){var t;void 0!==this._timeout&&(clearTimeout(this._timeout),this._timeout=void 0),this._dragging=!0,this._eBody.classList.add("lm_dragging"),this._eElement.classList.add("lm_dragging"),null===(t=this._oDocument.querySelector("iframe"))||void 0===t||t.style.setProperty("pointer-events","none"),this.emit("dragStart",this._nOriginalX,this._nOriginalY)}getPointerCoordinates(t){return{x:t.pageX,y:t.pageY}}}class eu{constructor(t,e,i){this._isVertical=t,this._size=e,this._grabSize=i<this._size?this._size:i,this._element=document.createElement("div"),this._element.classList.add("lm_splitter");let n=document.createElement("div");n.classList.add("lm_drag_handle");let o=this._grabSize-this._size,s=o/2;this._isVertical?(n.style.top=t9(-s),n.style.height=t9(this._size+o),this._element.classList.add("lm_vertical"),this._element.style.height=t9(this._size)):(n.style.left=t9(-s),n.style.width=t9(this._size+o),this._element.classList.add("lm_horizontal"),this._element.style.width=t9(this._size)),this._element.appendChild(n),this._dragListener=new ec(this._element,[n])}get element(){return this._element}destroy(){this._element.remove()}on(t,e){this._dragListener.on(t,e)}}class ep extends eh{constructor(t,e,i,n){switch(super(e,i,n,ep.createElement(document,t)),this._rowOrColumnParent=n,this._splitter=[],this.isRow=!t,this.isColumn=t,this._childElementContainer=this.element,this._splitterSize=e.layoutConfig.dimensions.borderWidth,this._splitterGrabSize=e.layoutConfig.dimensions.borderGrabWidth,this._isColumn=t,this._dimension=t?"height":"width",this._splitterPosition=null,this._splitterMinPosition=null,this._splitterMaxPosition=null,i.type){case R.row:case R.column:this._configType=i.type;break;default:throw new tJ("ROCCCT00925")}}newComponent(t,e,i,n){return this.newItem({type:"component",componentType:t,componentState:e,title:i},n)}addComponent(t,e,i,n){return this.addItem({type:"component",componentType:t,componentState:e,title:i},n)}newItem(t,e){e=this.addItem(t,e);let i=this.contentItems[e];return eh.isStack(i)&&q.isComponent(t)?i.contentItems[0]:i}addItem(t,e){this.layoutManager.checkMinimiseMaximisedStack();let i=q.resolve(t,!1),n=this.layoutManager.createAndInitContentItem(i,this);return this.addChild(n,e,!1)}addChild(t,e,i){if(void 0===e&&(e=this.contentItems.length),this.contentItems.length>0){let i=this.createSplitter(Math.max(0,e-1)).element;e>0?(this.contentItems[e-1].element.insertAdjacentElement("afterend",i),i.insertAdjacentElement("afterend",t.element)):(this.contentItems[0].element.insertAdjacentElement("beforebegin",i),i.insertAdjacentElement("beforebegin",t.element))}else this._childElementContainer.appendChild(t.element);super.addChild(t,e);let n=1/this.contentItems.length*100;if(!0===i)return this.emitBaseBubblingEvent("stateChanged"),e;for(let e=0;e<this.contentItems.length;e++){let i=this.contentItems[e];if(i===t)t.size=n;else{let t=i.size*=(100-n)/100;i.size=t}}return this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged"),e}removeChild(t,e){let i=this.contentItems.indexOf(t),n=Math.max(i-1,0);if(-1===i)throw Error("Can't remove child. ContentItem is not child of this Row or Column");if(this._splitter[n]&&(this._splitter[n].destroy(),this._splitter.splice(n,1)),super.removeChild(t,e),1===this.contentItems.length&&!0===this.isClosable){let t=this.contentItems[0];this.contentItems.length=0,this._rowOrColumnParent.replaceChild(this,t,!0)}else this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged")}replaceChild(t,e){let i=t.size;super.replaceChild(t,e),e.size=i,this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged")}updateSize(t){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(t)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}init(){if(!0!==this.isInitialised){this.updateNodeSize();for(let t=0;t<this.contentItems.length;t++)this._childElementContainer.appendChild(this.contentItems[t].element);super.init();for(let t=0;t<this.contentItems.length-1;t++)this.contentItems[t].element.insertAdjacentElement("afterend",this.createSplitter(t).element);this.initContentItems()}}toConfig(){return{type:this.type,content:this.calculateConfigContent(),size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,isClosable:this.isClosable}}setParent(t){this._rowOrColumnParent=t,super.setParent(t)}updateNodeSize(){this.contentItems.length>0&&(this.calculateRelativeSizes(),this.setAbsoluteSizes()),this.emitBaseBubblingEvent("stateChanged"),this.emit("resize")}setAbsoluteSizes(){let t=this.calculateAbsoluteSizes();for(let e=0;e<this.contentItems.length;e++)t.additionalPixel-e>0&&t.itemSizes[e]++,this._isColumn?(t7(this.contentItems[e].element,t.crossAxisSize),t8(this.contentItems[e].element,t.itemSizes[e])):(t7(this.contentItems[e].element,t.itemSizes[e]),t8(this.contentItems[e].element,t.crossAxisSize))}calculateAbsoluteSizes(){let t,e;let i=(this.contentItems.length-1)*this._splitterSize,{width:n,height:o}=t4(this.element);this._isColumn?(t=o-i,e=n):(t=n-i,e=o);let s=0,r=[];for(let e=0;e<this.contentItems.length;e++){let i;let n=this.contentItems[e];if(n.sizeUnit!==V.Percent)throw new tJ("ROCCAS6692");s+=i=Math.floor(n.size/100*t),r.push(i)}return{itemSizes:r,additionalPixel:Math.floor(t-s),totalSize:t,crossAxisSize:e}}calculateRelativeSizes(){let t=0,e=[],i=0;for(let n=0;n<this.contentItems.length;n++){let o=this.contentItems[n];switch(o.sizeUnit){case V.Percent:t+=o.size;break;case V.Fractional:e.push(o),i+=o.size;break;default:throw new tJ("ROCCRS49110",JSON.stringify(o))}}if(100!==Math.round(t)){if(100>Math.round(t)&&e.length>0){let n=100-t;for(let t=0;t<e.length;t++){let o=e[t];o.size=o.size/i*n,o.sizeUnit=V.Percent}this.respectMinItemSize()}else{if(Math.round(t)>100&&e.length>0){for(let t=0;t<e.length;t++){let n=e[t];n.size=n.size/i*50,n.sizeUnit=V.Percent}t+=50}for(let e=0;e<this.contentItems.length;e++){let i=this.contentItems[e];i.size=i.size/t*100}this.respectMinItemSize()}}else this.respectMinItemSize()}respectMinItemSize(){let t=this.calculateContentItemMinSize(this);if(!(t<=0||this.contentItems.length<=1)){let e=0,i=0,n=[],o=[],s=this.calculateAbsoluteSizes();for(let r=0;r<s.itemSizes.length;r++){let a;let l=s.itemSizes[r];l<t?(i+=t-l,a={size:t}):(e+=l-t,a={size:l},n.push(a)),o.push(a)}if(0===i||i>e)return;{let r=i/e,a=i;for(let e=0;e<n.length;e++){let i=n[e],o=Math.round((i.size-t)*r);a-=o,i.size-=o}0!==a&&(o[o.length-1].size-=a);for(let t=0;t<this.contentItems.length;t++)this.contentItems[t].size=o[t].size/s.totalSize*100}}}createSplitter(t){let e=new eu(this._isColumn,this._splitterSize,this._splitterGrabSize);return e.on("drag",(t,i)=>this.onSplitterDrag(e,t,i)),e.on("dragStop",()=>this.onSplitterDragStop(e)),e.on("dragStart",()=>this.onSplitterDragStart(e)),this._splitter.splice(t,0,e),e}getSplitItems(t){let e=this._splitter.indexOf(t);return{before:this.contentItems[e],after:this.contentItems[e+1]}}calculateContentItemMinSize(t){let e=t.minSize;if(void 0!==e){if(t.minSizeUnit===V.Pixel)return e;throw new tJ("ROCGMD98831",JSON.stringify(t))}{let t=this.layoutManager.layoutConfig.dimensions;return this._isColumn?t.defaultMinItemHeight:t.defaultMinItemWidth}}calculateContentItemsTotalMinSize(t){let e=0;for(let i of t)e+=this.calculateContentItemMinSize(i);return e}onSplitterDragStart(t){let e=this.getSplitItems(t),i=t5(e.before.element.style[this._dimension]),n=t5(e.after.element.style[this._dimension]),o=this.calculateContentItemsTotalMinSize(e.before.contentItems),s=this.calculateContentItemsTotalMinSize(e.after.contentItems);this._splitterPosition=0,this._splitterMinPosition=-1*(i-o),this._splitterMaxPosition=n-s}onSplitterDrag(t,e,i){let n=this._isColumn?i:e;if(null===this._splitterMinPosition||null===this._splitterMaxPosition)throw new t0("ROCOSD59226");n=Math.min(n=Math.max(n,this._splitterMinPosition),this._splitterMaxPosition),this._splitterPosition=n;let o=t9(n);this._isColumn?t.element.style.top=o:t.element.style.left=o}onSplitterDragStop(t){if(null===this._splitterPosition)throw new t0("ROCOSDS66932");{let e=this.getSplitItems(t),i=t5(e.before.element.style[this._dimension]),n=t5(e.after.element.style[this._dimension]),o=(this._splitterPosition+i)/(i+n),s=e.before.size+e.after.size;e.before.size=o*s,e.after.size=(1-o)*s,t.element.style.top=t9(0),t.element.style.left=t9(0),globalThis.requestAnimationFrame(()=>this.updateSize(!1))}}}(E=ep||(ep={})).getElementDimensionSize=function(t,e){return"width"===e?t.offsetWidth:t.offsetHeight},E.setElementDimensionSize=function(t,e,i){return"width"===e?t7(t,i):t8(t,i)},E.createElement=function(t,e){let i=t.createElement("div");return i.classList.add("lm_item"),e?i.classList.add("lm_column"):i.classList.add("lm_row"),i};class eg extends em{constructor(t,e,i){super(t,j.create(e),null,eg.createElement(document)),this.isGround=!0,this._childElementContainer=this.element,this._containerElement=i;let n=null;for(;;){let t=n?n.previousSibling:this._containerElement.lastChild;if(!(t instanceof Element&&t.classList.contains("lm_content")))break;n=t}this._containerElement.insertBefore(this.element,n)}init(){if(!0!==this.isInitialised){this.updateNodeSize();for(let t=0;t<this.contentItems.length;t++)this._childElementContainer.appendChild(this.contentItems[t].element);super.init(),this.initContentItems()}}loadRoot(t){if(this.clearRoot(),void 0!==t){let e=this.layoutManager.createAndInitContentItem(t,this);this.addChild(e,0)}}clearRoot(){let t=this.contentItems;switch(t.length){case 0:return;case 1:return void t[0].remove();default:throw new tJ("GILR07721")}}addItem(t,e){let i;this.layoutManager.checkMinimiseMaximisedStack();let n=q.resolve(t,!1);if((i=this.contentItems.length>0?this.contentItems[0]:this).isComponent)throw Error("Cannot add item as child to ComponentItem");{let t=this.layoutManager.createAndInitContentItem(n,i);return e=i.addChild(t,e),i===this?-1:e}}loadComponentAsRoot(t){this.clearRoot();let e=q.resolve(t,!1);if(e.maximised)throw Error("Root Component cannot be maximised");{let t=new ed(this.layoutManager,e,this);t.init(),this.addChild(t,0)}}addChild(t,e){if(this.contentItems.length>0)throw Error("Ground node can only have a single child");return this._childElementContainer.appendChild(t.element),e=super.addChild(t,e),this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged"),e}calculateConfigContent(){let t=this.contentItems,e=t.length,i=Array(e);for(let n=0;n<e;n++){let e=t[n].toConfig();if(!$.isRootItemConfig(e))throw new tJ("RCCC66832");i[n]=e}return i}setSize(t,e){void 0===t||void 0===e?this.updateSize(!1):(t7(this.element,t),t8(this.element,e),this.contentItems.length>0&&(t7(this.contentItems[0].element,t),t8(this.contentItems[0].element,e)),this.updateContentItemsSize(!1))}updateSize(t){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(t)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}createSideAreas(){let t=eg.Area.oppositeSides,e=Array(Object.keys(t).length),i=0;for(let n in t){let o=this.getElementArea();if(null===o)throw new t0("RCSA77553");o.side=n,"2"===t[n][1]?o[n]=o[t[n]]-50:o[n]=o[t[n]]+50,o.surface=(o.x2-o.x1)*(o.y2-o.y1),e[i++]=o}return e}highlightDropZone(t,e,i){this.layoutManager.tabDropPlaceholder.remove(),super.highlightDropZone(t,e,i)}onDrop(t,e){if(t.isComponent){let e=H.createDefault(),i=t;e.header=W.Header.createCopy(i.headerConfig);let n=this.layoutManager.createAndInitContentItem(e,this);n.addChild(t),t=n}if(0===this.contentItems.length)this.addChild(t);else{if(t.type===R.row||t.type===R.column){let e=H.createDefault(),i=this.layoutManager.createContentItem(e,this);i.addChild(t),t=i}let i="x"==e.side[0]?R.row:R.column,n="2"==e.side[1],o=this.contentItems[0];if(o instanceof ep&&o.type===i){let e=o.contentItems[n?0:o.contentItems.length-1];o.addChild(t,n?0:void 0,!0),e.size*=.5,t.size=e.size,t.sizeUnit=V.Percent,o.updateSize(!1)}else{let e=B.createDefault(i),s=this.layoutManager.createContentItem(e,this);this.replaceChild(o,s),s.addChild(t,n?0:void 0,!0),s.addChild(o,n?void 0:0,!0),o.size=50,t.size=50,t.sizeUnit=V.Percent,s.updateSize(!1)}}}dock(){throw new tJ("GID87731")}validateDocking(){throw new tJ("GIVD87732")}getAllContentItems(){let t=[this];return this.deepGetAllContentItems(this.contentItems,t),t}getConfigMaximisedItems(){let t=[];return this.deepFilterContentItems(this.contentItems,t,t=>!(!eh.isStack(t)||!t.initialWantMaximise)||!(!eh.isComponentItem(t)||!t.initialWantMaximise)),t}getItemsByPopInParentId(t){let e=[];return this.deepFilterContentItems(this.contentItems,e,e=>e.popInParentIds.includes(t)),e}toConfig(){throw Error("Cannot generate GroundItem config")}setActiveComponentItem(t,e,i){}updateNodeSize(){let{width:t,height:e}=t4(this._containerElement);t7(this.element,t),t8(this.element,e),this.contentItems.length>0&&(t7(this.contentItems[0].element,t),t8(this.contentItems[0].element,e))}deepGetAllContentItems(t,e){for(let i=0;i<t.length;i++){let n=t[i];e.push(n),this.deepGetAllContentItems(n.contentItems,e)}}deepFilterContentItems(t,e,i){for(let n=0;n<t.length;n++){let o=t[n];i(o)&&e.push(o),this.deepFilterContentItems(o.contentItems,e,i)}}}((x=eg||(eg={})).Area||(x.Area={})).oppositeSides={y2:"y1",x2:"x1",y1:"y2",x1:"x2"},x.createElement=function(t){let e=t.createElement("div");return e.classList.add("lm_goldenlayout"),e.classList.add("lm_item"),e.classList.add("lm_root"),e};class ef{constructor(t,e,i,n){this._header=t,this._pushEvent=n,this._clickEventListener=t=>this.onClick(t),this._touchStartEventListener=t=>this.onTouchStart(t),this._element=document.createElement("div"),this._element.classList.add(i),this._element.title=e,this._header.on("destroy",()=>this.destroy()),this._element.addEventListener("click",this._clickEventListener,{passive:!0}),this._element.addEventListener("touchstart",this._touchStartEventListener,{passive:!0}),this._header.controlsContainerElement.appendChild(this._element)}get element(){return this._element}destroy(){var t;this._element.removeEventListener("click",this._clickEventListener),this._element.removeEventListener("touchstart",this._touchStartEventListener),null===(t=this._element.parentNode)||void 0===t||t.removeChild(this._element)}onClick(t){this._pushEvent(t)}onTouchStart(t){this._pushEvent(t)}}class ev{constructor(t,e,i,n,o){var s;this._layoutManager=t,this._componentItem=e,this._closeEvent=i,this._focusEvent=n,this._dragStartEvent=o,this._isActive=!1,this._tabClickListener=t=>this.onTabClickDown(t),this._tabTouchStartListener=t=>this.onTabTouchStart(t),this._closeClickListener=()=>this.onCloseClick(),this._closeTouchStartListener=()=>this.onCloseTouchStart(),this._dragStartListener=(t,e)=>this.onDragStart(t,e),this._contentItemDestroyListener=()=>this.onContentItemDestroy(),this._tabTitleChangedListener=t=>this.setTitle(t),this._element=document.createElement("div"),this._element.classList.add("lm_tab"),this._titleElement=document.createElement("span"),this._titleElement.classList.add("lm_title"),this._closeElement=document.createElement("div"),this._closeElement.classList.add("lm_close_tab"),this._element.appendChild(this._titleElement),this._element.appendChild(this._closeElement),e.isClosable?this._closeElement.style.display="":this._closeElement.style.display="none",this.setTitle(e.title),this._componentItem.on("titleChanged",this._tabTitleChangedListener),(null!==(s=e.reorderEnabled)&&void 0!==s?s:this._layoutManager.layoutConfig.settings.reorderEnabled)&&this.enableReorder(),this._element.addEventListener("click",this._tabClickListener,{passive:!0}),this._element.addEventListener("touchstart",this._tabTouchStartListener,{passive:!0}),this._componentItem.isClosable?(this._closeElement.addEventListener("click",this._closeClickListener,{passive:!0}),this._closeElement.addEventListener("touchstart",this._closeTouchStartListener,{passive:!0})):(this._closeElement.remove(),this._closeElement=void 0),this._componentItem.setTab(this),this._layoutManager.emit("tabCreated",this)}get isActive(){return this._isActive}get componentItem(){return this._componentItem}get contentItem(){return this._componentItem}get element(){return this._element}get titleElement(){return this._titleElement}get closeElement(){return this._closeElement}get reorderEnabled(){return void 0!==this._dragListener}set reorderEnabled(t){t!==this.reorderEnabled&&(t?this.enableReorder():this.disableReorder())}setTitle(t){this._titleElement.innerText=t,this._element.title=t}setActive(t){t!==this._isActive&&(this._isActive=t,t?this._element.classList.add("lm_active"):this._element.classList.remove("lm_active"))}destroy(){var t,e;this._closeEvent=void 0,this._focusEvent=void 0,this._dragStartEvent=void 0,this._element.removeEventListener("click",this._tabClickListener),this._element.removeEventListener("touchstart",this._tabTouchStartListener),null===(t=this._closeElement)||void 0===t||t.removeEventListener("click",this._closeClickListener),null===(e=this._closeElement)||void 0===e||e.removeEventListener("touchstart",this._closeTouchStartListener),this._componentItem.off("titleChanged",this._tabTitleChangedListener),this.reorderEnabled&&this.disableReorder(),this._element.remove()}setBlurred(){this._element.classList.remove("lm_focused"),this._titleElement.classList.remove("lm_focused")}setFocused(){this._element.classList.add("lm_focused"),this._titleElement.classList.add("lm_focused")}onDragStart(t,e){if(void 0===this._dragListener)throw new t1("TODSDLU10093");if(void 0===this._dragStartEvent)throw new t1("TODS23309");this._dragStartEvent(t,e,this._dragListener,this.componentItem)}onContentItemDestroy(){void 0!==this._dragListener&&(this._dragListener.destroy(),this._dragListener=void 0)}onTabClickDown(t){let e=t.target;e!==this._element&&e!==this._titleElement||(0===t.button?this.notifyFocus():1===t.button&&this._componentItem.isClosable&&this.notifyClose())}onTabTouchStart(t){t.target===this._element&&this.notifyFocus()}onCloseClick(){this.notifyClose()}onCloseTouchStart(){this.notifyClose()}notifyClose(){if(void 0===this._closeEvent)throw new t1("TNC15007");this._closeEvent(this._componentItem)}notifyFocus(){if(void 0===this._focusEvent)throw new t1("TNA15007");this._focusEvent(this._componentItem)}enableReorder(){this._dragListener=new ec(this._element,[this._titleElement]),this._dragListener.on("dragStart",this._dragStartListener),this._componentItem.on("destroy",this._contentItemDestroyListener)}disableReorder(){if(void 0===this._dragListener)throw new t1("TDR87745");this._componentItem.off("destroy",this._contentItemDestroyListener),this._dragListener.off("dragStart",this._dragStartListener),this._dragListener=void 0}}class e_{constructor(t,e,i,n,o){this._layoutManager=t,this._componentRemoveEvent=e,this._componentFocusEvent=i,this._componentDragStartEvent=n,this._dropdownActiveChangedEvent=o,this._tabs=[],this._lastVisibleTabIndex=-1,this._dropdownActive=!1,this._element=document.createElement("section"),this._element.classList.add("lm_tabs"),this._dropdownElement=document.createElement("section"),this._dropdownElement.classList.add("lm_tabdropdown_list"),this._dropdownElement.style.display="none"}get tabs(){return this._tabs}get tabCount(){return this._tabs.length}get lastVisibleTabIndex(){return this._lastVisibleTabIndex}get element(){return this._element}get dropdownElement(){return this._dropdownElement}get dropdownActive(){return this._dropdownActive}destroy(){for(let t=0;t<this._tabs.length;t++)this._tabs[t].destroy()}createTab(t,e){for(let e=0;e<this._tabs.length;e++)if(this._tabs[e].componentItem===t)return;let i=new ev(this._layoutManager,t,t=>this.handleTabCloseEvent(t),t=>this.handleTabFocusEvent(t),(t,e,i,n)=>this.handleTabDragStartEvent(t,e,i,n));void 0===e&&(e=this._tabs.length),this._tabs.splice(e,0,i),e<this._element.childNodes.length?this._element.insertBefore(i.element,this._element.childNodes[e]):this._element.appendChild(i.element)}removeTab(t){for(let e=0;e<this._tabs.length;e++)if(this._tabs[e].componentItem===t)return this._tabs[e].destroy(),void this._tabs.splice(e,1);throw Error("contentItem is not controlled by this header")}processActiveComponentChanged(t){let e=-1;for(let i=0;i<this._tabs.length;i++){let n=this._tabs[i].componentItem===t;this._tabs[i].setActive(n),n&&(e=i)}if(e<0)throw new tJ("HSACI56632");if(this._layoutManager.layoutConfig.settings.reorderOnTabMenuClick&&-1!==this._lastVisibleTabIndex&&e>this._lastVisibleTabIndex){let t=this._tabs[e];for(let t=e;t>0;t--)this._tabs[t]=this._tabs[t-1];this._tabs[0]=t}}updateTabSizes(t,e){let i=!1;this.tryUpdateTabSizes(i,t,e)||(i=!0,this.tryUpdateTabSizes(i,t,e)),i!==this._dropdownActive&&(this._dropdownActive=i,this._dropdownActiveChangedEvent())}tryUpdateTabSizes(t,e,i){if(this._tabs.length>0){if(void 0===i)throw Error("non-empty tabs must have active component item");let n=0,o=!1,s=this._layoutManager.layoutConfig.settings.tabOverlapAllowance,r=this._tabs.indexOf(i.tab),a=this._tabs[r];this._lastVisibleTabIndex=-1;for(let i=0;i<this._tabs.length;i++){let l=this._tabs[i].element;l.parentElement!==this._element&&this._element.appendChild(l);let h=t5(getComputedStyle(a.element).marginRight);n+=l.offsetWidth+h;let d=0;if(r<=i)d=n;else{let t=t5(getComputedStyle(a.element).marginRight);d=n+a.element.offsetWidth+t}if(d>e){if(o)i===r&&(l.style.zIndex="auto",l.style.marginLeft="",l.parentElement!==this._element&&this._element.appendChild(l));else{let t;if((t=r>0&&r<=i?(d-e)/(i-1):(d-e)/i)<s){for(let e=0;e<=i;e++){let n=e!==r&&0!==e?"-"+t9(t):"";this._tabs[e].element.style.zIndex=t9(i-e),this._tabs[e].element.style.marginLeft=n}this._lastVisibleTabIndex=i,l.parentElement!==this._element&&this._element.appendChild(l)}else o=!0}if(o&&i!==r){if(!t)return!1;l.style.zIndex="auto",l.style.marginLeft="",l.parentElement!==this._dropdownElement&&this._dropdownElement.appendChild(l)}}else this._lastVisibleTabIndex=i,l.style.zIndex="auto",l.style.marginLeft="",l.parentElement!==this._element&&this._element.appendChild(l)}}return!0}showAdditionalTabsDropdown(){this._dropdownElement.style.display=""}hideAdditionalTabsDropdown(){this._dropdownElement.style.display="none"}handleTabCloseEvent(t){this._componentRemoveEvent(t)}handleTabFocusEvent(t){this._componentFocusEvent(t)}handleTabDragStartEvent(t,e,i,n){this._componentDragStartEvent(t,e,i,n)}}class ey extends er{constructor(t,e,i,n,o,s,r,a,l,h,d,m,c){super(),this._layoutManager=t,this._parent=e,this._configClosable=n,this._getActiveComponentItemEvent=o,this._popoutEvent=r,this._maximiseToggleEvent=a,this._clickEvent=l,this._touchStartEvent=h,this._componentRemoveEvent=d,this._componentFocusEvent=m,this._componentDragStartEvent=c,this._clickListener=t=>this.onClick(t),this._touchStartListener=t=>this.onTouchStart(t),this._rowColumnClosable=!0,this._closeButton=null,this._popoutButton=null,this._tabsContainer=new e_(this._layoutManager,t=>this.handleTabInitiatedComponentRemoveEvent(t),t=>this.handleTabInitiatedComponentFocusEvent(t),(t,e,i,n)=>this.handleTabInitiatedDragStartEvent(t,e,i,n),()=>this.processTabDropdownActiveChanged()),this._show=i.show,this._popoutEnabled=i.popoutEnabled,this._popoutLabel=i.popoutLabel,this._maximiseEnabled=i.maximiseEnabled,this._maximiseLabel=i.maximiseLabel,this._minimiseEnabled=i.minimiseEnabled,this._minimiseLabel=i.minimiseLabel,this._closeEnabled=i.closeEnabled,this._closeLabel=i.closeLabel,this._tabDropdownEnabled=i.tabDropdownEnabled,this._tabDropdownLabel=i.tabDropdownLabel,this.setSide(i.side),this._canRemoveComponent=this._configClosable,this._element=document.createElement("section"),this._element.classList.add("lm_header"),this._controlsContainerElement=document.createElement("section"),this._controlsContainerElement.classList.add("lm_controls"),this._element.appendChild(this._tabsContainer.element),this._element.appendChild(this._controlsContainerElement),this._element.appendChild(this._tabsContainer.dropdownElement),this._element.addEventListener("click",this._clickListener,{passive:!0}),this._element.addEventListener("touchstart",this._touchStartListener,{passive:!0}),this._documentMouseUpListener=()=>this._tabsContainer.hideAdditionalTabsDropdown(),globalThis.document.addEventListener("mouseup",this._documentMouseUpListener,{passive:!0}),this._tabControlOffset=this._layoutManager.layoutConfig.settings.tabControlOffset,this._tabDropdownEnabled&&(this._tabDropdownButton=new ef(this,this._tabDropdownLabel,"lm_tabdropdown",()=>this._tabsContainer.showAdditionalTabsDropdown())),this._popoutEnabled&&(this._popoutButton=new ef(this,this._popoutLabel,"lm_popout",()=>this.handleButtonPopoutEvent())),this._maximiseEnabled&&(this._maximiseButton=new ef(this,this._maximiseLabel,"lm_maximise",t=>this.handleButtonMaximiseToggleEvent(t))),this._configClosable&&(this._closeButton=new ef(this,this._closeLabel,"lm_close",()=>s())),this.processTabDropdownActiveChanged()}get show(){return this._show}get side(){return this._side}get leftRightSided(){return this._leftRightSided}get layoutManager(){return this._layoutManager}get parent(){return this._parent}get tabs(){return this._tabsContainer.tabs}get lastVisibleTabIndex(){return this._tabsContainer.lastVisibleTabIndex}get element(){return this._element}get tabsContainerElement(){return this._tabsContainer.element}get controlsContainerElement(){return this._controlsContainerElement}destroy(){this.emit("destroy"),this._popoutEvent=void 0,this._maximiseToggleEvent=void 0,this._clickEvent=void 0,this._touchStartEvent=void 0,this._componentRemoveEvent=void 0,this._componentFocusEvent=void 0,this._componentDragStartEvent=void 0,this._tabsContainer.destroy(),globalThis.document.removeEventListener("mouseup",this._documentMouseUpListener),this._element.remove()}createTab(t,e){this._tabsContainer.createTab(t,e)}removeTab(t){this._tabsContainer.removeTab(t)}processActiveComponentChanged(t){this._tabsContainer.processActiveComponentChanged(t),this.updateTabSizes()}setSide(t){this._side=t,this._leftRightSided=[A.right,A.left].includes(this._side)}setRowColumnClosable(t){this._rowColumnClosable=t,this.updateClosability()}updateClosability(){let t;if(this._configClosable){if(this._rowColumnClosable){t=!0;let e=this.tabs.length;for(let i=0;i<e;i++)if(!this._tabsContainer.tabs[i].componentItem.isClosable){t=!1;break}}else t=!1}else t=!1;null!==this._closeButton&&t6(this._closeButton.element,t),null!==this._popoutButton&&t6(this._popoutButton.element,t),this._canRemoveComponent=t||this._tabsContainer.tabCount>1}applyFocusedValue(t){t?this._element.classList.add("lm_focused"):this._element.classList.remove("lm_focused")}processMaximised(){if(void 0===this._maximiseButton)throw new t1("HPMAX16997");this._maximiseButton.element.setAttribute("title",this._minimiseLabel)}processMinimised(){if(void 0===this._maximiseButton)throw new t1("HPMIN16997");this._maximiseButton.element.setAttribute("title",this._maximiseLabel)}updateTabSizes(){if(this._tabsContainer.tabCount>0){let t;let e=this._show?this._layoutManager.layoutConfig.dimensions.headerHeight:0;this._leftRightSided?(this._element.style.height="",this._element.style.width=t9(e)):(this._element.style.width="",this._element.style.height=t9(e)),t=this._leftRightSided?this._element.offsetHeight-this._controlsContainerElement.offsetHeight-this._tabControlOffset:this._element.offsetWidth-this._controlsContainerElement.offsetWidth-this._tabControlOffset,this._tabsContainer.updateTabSizes(t,this._getActiveComponentItemEvent())}}handleTabInitiatedComponentRemoveEvent(t){if(this._canRemoveComponent){if(void 0===this._componentRemoveEvent)throw new t1("HHTCE22294");this._componentRemoveEvent(t)}}handleTabInitiatedComponentFocusEvent(t){if(void 0===this._componentFocusEvent)throw new t1("HHTAE22294");this._componentFocusEvent(t)}handleTabInitiatedDragStartEvent(t,e,i,n){if(this._canRemoveComponent){if(void 0===this._componentDragStartEvent)throw new t1("HHTDSE22294");this._componentDragStartEvent(t,e,i,n)}else i.cancelDrag()}processTabDropdownActiveChanged(){void 0!==this._tabDropdownButton&&t6(this._tabDropdownButton.element,this._tabsContainer.dropdownActive)}handleButtonPopoutEvent(){if(this._layoutManager.layoutConfig.settings.popoutWholeStack){if(void 0===this._popoutEvent)throw new t1("HHBPOE17834");this._popoutEvent()}else{let t=this._getActiveComponentItemEvent();t&&t.popout()}}handleButtonMaximiseToggleEvent(t){if(void 0===this._maximiseToggleEvent)throw new t1("HHBMTE16834");this._maximiseToggleEvent()}onClick(t){t.target===this._element&&this.notifyClick(t)}onTouchStart(t){t.target===this._element&&this.notifyTouchStart(t)}notifyClick(t){if(void 0===this._clickEvent)throw new t1("HNHC46834");this._clickEvent(t)}notifyTouchStart(t){if(void 0===this._touchStartEvent)throw new t1("HNHTS46834");this._touchStartEvent(t)}}class eC extends em{constructor(t,e,i){var n,o,s,r,a,l,h,d,m,c,u,p,g,f,v,_,y,C,w;let I;super(t,e,i,eC.createElement(document)),this._headerSideChanged=!1,this._resizeListener=()=>this.handleResize(),this._maximisedListener=()=>this.handleMaximised(),this._minimisedListener=()=>this.handleMinimised(),this._headerConfig=e.header;let b=t.layoutConfig.header,S=e.content;I=1!==S.length?void 0:S[0].header,this._initialWantMaximise=e.maximised,this._initialActiveItemIndex=null!==(n=e.activeItemIndex)&&void 0!==n?n:0;let E=null!==(r=null!==(s=null===(o=this._headerConfig)||void 0===o?void 0:o.show)&&void 0!==s?s:null==I?void 0:I.show)&&void 0!==r?r:b.show,x=null!==(h=null!==(l=null===(a=this._headerConfig)||void 0===a?void 0:a.popout)&&void 0!==l?l:null==I?void 0:I.popout)&&void 0!==h?h:b.popout,L=null!==(c=null!==(m=null===(d=this._headerConfig)||void 0===d?void 0:d.maximise)&&void 0!==m?m:null==I?void 0:I.maximise)&&void 0!==c?c:b.maximise,z=null!==(g=null!==(p=null===(u=this._headerConfig)||void 0===u?void 0:u.close)&&void 0!==p?p:null==I?void 0:I.close)&&void 0!==g?g:b.close,M=null!==(_=null!==(v=null===(f=this._headerConfig)||void 0===f?void 0:f.minimise)&&void 0!==v?v:null==I?void 0:I.minimise)&&void 0!==_?_:b.minimise,P=null!==(w=null!==(C=null===(y=this._headerConfig)||void 0===y?void 0:y.tabDropdown)&&void 0!==C?C:null==I?void 0:I.tabDropdown)&&void 0!==w?w:b.tabDropdown;this._maximisedEnabled=!1!==L;let T={show:!1!==E,side:!1===E?A.top:E,popoutEnabled:!1!==x,popoutLabel:!1===x?"":x,maximiseEnabled:this._maximisedEnabled,maximiseLabel:!1===L?"":L,closeEnabled:!1!==z,closeLabel:!1===z?"":z,minimiseEnabled:!0,minimiseLabel:M,tabDropdownEnabled:!1!==P,tabDropdownLabel:!1===P?"":P};this._header=new ey(t,this,T,e.isClosable&&!1!==z,()=>this.getActiveComponentItem(),()=>this.remove(),()=>this.handlePopoutEvent(),()=>this.toggleMaximise(),t=>this.handleHeaderClickEvent(t),t=>this.handleHeaderTouchStartEvent(t),t=>this.handleHeaderComponentRemoveEvent(t),t=>this.handleHeaderComponentFocusEvent(t),(t,e,i,n)=>this.handleHeaderComponentStartDragEvent(t,e,i,n)),this.isStack=!0,this._childElementContainer=document.createElement("section"),this._childElementContainer.classList.add("lm_items"),this.on("resize",this._resizeListener),this._maximisedEnabled&&(this.on("maximised",this._maximisedListener),this.on("minimised",this._minimisedListener)),this.element.appendChild(this._header.element),this.element.appendChild(this._childElementContainer),this.setupHeaderPosition(),this._header.updateClosability()}get childElementContainer(){return this._childElementContainer}get header(){return this._header}get headerShow(){return this._header.show}get headerSide(){return this._header.side}get headerLeftRightSided(){return this._header.leftRightSided}get contentAreaDimensions(){return this._contentAreaDimensions}get initialWantMaximise(){return this._initialWantMaximise}get isMaximised(){return this===this.layoutManager.maximisedStack}get stackParent(){if(!this.parent)throw Error("Stack should always have a parent");return this.parent}updateSize(t){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(t)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}init(){if(!0===this.isInitialised)return;this.updateNodeSize();for(let t=0;t<this.contentItems.length;t++)this._childElementContainer.appendChild(this.contentItems[t].element);super.init();let t=this.contentItems,e=t.length;if(e>0){if(this._initialActiveItemIndex<0||this._initialActiveItemIndex>=e)throw Error(`ActiveItemIndex out of range: ${this._initialActiveItemIndex} id: ${this.id}`);for(let i=0;i<e;i++){let e=t[i];if(!(e instanceof ed))throw Error(`Stack Content Item is not of type ComponentItem: ${i} id: ${this.id}`);this._header.createTab(e,i),e.hide(),e.container.setBaseLogicalZIndex()}this.setActiveComponentItem(t[this._initialActiveItemIndex],!1),this._header.updateTabSizes()}this._header.updateClosability(),this.initContentItems()}setActiveContentItem(t){if(!eh.isComponentItem(t))throw Error("Stack.setActiveContentItem: item is not a ComponentItem");this.setActiveComponentItem(t,!1)}setActiveComponentItem(t,e,i=!1){if(this._activeComponentItem!==t){if(-1===this.contentItems.indexOf(t))throw Error("componentItem is not a child of this stack");this.layoutManager.beginSizeInvalidation();try{void 0!==this._activeComponentItem&&this._activeComponentItem.hide(),this._activeComponentItem=t,this._header.processActiveComponentChanged(t),t.show()}finally{this.layoutManager.endSizeInvalidation()}this.emit("activeContentItemChanged",t),this.layoutManager.emit("activeContentItemChanged",t),this.emitStateChangedEvent()}(this.focused||e)&&this.layoutManager.setFocusedComponentItem(t,i)}getActiveContentItem(){var t;return null!==(t=this.getActiveComponentItem())&&void 0!==t?t:null}getActiveComponentItem(){return this._activeComponentItem}focusActiveContentItem(){var t;null===(t=this._activeComponentItem)||void 0===t||t.focus()}setFocusedValue(t){this._header.applyFocusedValue(t),super.setFocusedValue(t)}setRowColumnClosable(t){this._header.setRowColumnClosable(t)}newComponent(t,e,i,n){return this.newItem({type:"component",componentType:t,componentState:e,title:i},n)}addComponent(t,e,i,n){return this.addItem({type:"component",componentType:t,componentState:e,title:i},n)}newItem(t,e){return e=this.addItem(t,e),this.contentItems[e]}addItem(t,e){this.layoutManager.checkMinimiseMaximisedStack();let i=q.resolve(t,!1),n=this.layoutManager.createAndInitContentItem(i,this);return this.addChild(n,e)}addChild(t,e,i=!1){if(void 0!==e&&e>this.contentItems.length)throw e-=1,new tJ("SAC99728");if(t instanceof ed)return e=super.addChild(t,e),this._childElementContainer.appendChild(t.element),this._header.createTab(t,e),this.setActiveComponentItem(t,i),this._header.updateTabSizes(),this.updateSize(!1),t.container.setBaseLogicalZIndex(),this._header.updateClosability(),this.emitStateChangedEvent(),e;throw new tJ("SACC88532")}removeChild(t,e){let i=this.contentItems.indexOf(t),n=1===this.contentItems.length;this._activeComponentItem!==t||(t.focused&&t.blur(),n)||this.setActiveComponentItem(this.contentItems[0===i?1:i-1],!1),this._header.removeTab(t),super.removeChild(t,e),n||this._header.updateClosability(),this.emitStateChangedEvent()}toggleMaximise(){this.isMaximised?this.minimise():this.maximise()}maximise(){if(!this.isMaximised){this.layoutManager.setMaximisedStack(this);let t=this.contentItems,e=t.length;for(let i=0;i<e;i++){let e=t[i];if(!(e instanceof ed))throw new tJ("SMAXI87773");e.enterStackMaximised()}this.emitStateChangedEvent()}}minimise(){if(this.isMaximised){this.layoutManager.setMaximisedStack(void 0);let t=this.contentItems,e=t.length;for(let i=0;i<e;i++){let e=t[i];if(!(e instanceof ed))throw new tJ("SMINI87773");e.exitStackMaximised()}this.emitStateChangedEvent()}}destroy(){var t;(null===(t=this._activeComponentItem)||void 0===t?void 0:t.focused)&&this._activeComponentItem.blur(),super.destroy(),this.off("resize",this._resizeListener),this._maximisedEnabled&&(this.off("maximised",this._maximisedListener),this.off("minimised",this._minimisedListener)),this._header.destroy()}toConfig(){let t;if(this._activeComponentItem&&(t=this.contentItems.indexOf(this._activeComponentItem))<0)throw Error("active component item not found in stack");if(this.contentItems.length>0&&void 0===t)throw Error("expected non-empty stack to have an active component item");return{type:"stack",content:this.calculateConfigContent(),size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,isClosable:this.isClosable,maximised:this.isMaximised,header:this.createHeaderConfig(),activeItemIndex:t}}onDrop(t,e){if("header"===this._dropSegment){if(this.resetHeaderDropZone(),void 0===this._dropIndex)throw new t1("SODDI68990");return void this.addChild(t,this._dropIndex)}if("body"===this._dropSegment)return void this.addChild(t,0,!0);let i="top"===this._dropSegment||"bottom"===this._dropSegment,n="left"===this._dropSegment||"right"===this._dropSegment,o="top"===this._dropSegment||"left"===this._dropSegment,s=i&&this.stackParent.isColumn||n&&this.stackParent.isRow;if(t.isComponent){let e=H.createDefault();e.header=this.createHeaderConfig();let i=this.layoutManager.createAndInitContentItem(e,this);i.addChild(t),t=i}if(t.type===R.row||t.type===R.column){let e=H.createDefault();e.header=this.createHeaderConfig();let i=this.layoutManager.createContentItem(e,this);i.addChild(t),t=i}if(s){let e=this.stackParent.contentItems.indexOf(this);this.stackParent.addChild(t,o?e:e+1,!0),this.size*=.5,t.size=this.size,t.sizeUnit=this.sizeUnit,this.stackParent.updateSize(!1)}else{let e=i?R.column:R.row,n=B.createDefault(e),s=this.layoutManager.createContentItem(n,this);this.stackParent.replaceChild(this,s),s.addChild(t,o?0:void 0,!0),s.addChild(this,o?void 0:0,!0),this.size=50,t.size=50,t.sizeUnit=V.Percent,s.updateSize(!1)}}highlightDropZone(t,e){for(let i in this._contentAreaDimensions){let n=this._contentAreaDimensions[i].hoverArea;if(n.x1<t&&n.x2>t&&n.y1<e&&n.y2>e)return void("header"===i?(this._dropSegment="header",this.highlightHeaderDropZone(this._header.leftRightSided?e:t)):(this.resetHeaderDropZone(),this.highlightBodyDropZone(i)))}}getArea(){if("none"===this.element.style.display)return null;let t=super.getElementArea(this._header.element),e=super.getElementArea(this._childElementContainer);if(null===t||null===e)throw new t0("SGAHC13086");let i=e.x2-e.x1,n=e.y2-e.y1;return this._contentAreaDimensions={header:{hoverArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}}},0===this.contentItems.length?this._contentAreaDimensions.body={hoverArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},highlightArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}}:(this._contentAreaDimensions.left={hoverArea:{x1:e.x1,y1:e.y1,x2:e.x1+.25*i,y2:e.y2},highlightArea:{x1:e.x1,y1:e.y1,x2:e.x1+.5*i,y2:e.y2}},this._contentAreaDimensions.top={hoverArea:{x1:e.x1+.25*i,y1:e.y1,x2:e.x1+.75*i,y2:e.y1+.5*n},highlightArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y1+.5*n}},this._contentAreaDimensions.right={hoverArea:{x1:e.x1+.75*i,y1:e.y1,x2:e.x2,y2:e.y2},highlightArea:{x1:e.x1+.5*i,y1:e.y1,x2:e.x2,y2:e.y2}},this._contentAreaDimensions.bottom={hoverArea:{x1:e.x1+.25*i,y1:e.y1+.5*n,x2:e.x1+.75*i,y2:e.y2},highlightArea:{x1:e.x1,y1:e.y1+.5*n,x2:e.x2,y2:e.y2}}),super.getElementArea(this.element)}positionHeader(t){this._header.side!==t&&(this._header.setSide(t),this._headerSideChanged=!0,this.setupHeaderPosition())}updateNodeSize(){if("none"!==this.element.style.display){let t=t4(this.element);this._header.show&&(t[this._header.leftRightSided?T.width:T.height]-=this.layoutManager.layoutConfig.dimensions.headerHeight),this._childElementContainer.style.width=t9(t.width),this._childElementContainer.style.height=t9(t.height);for(let e=0;e<this.contentItems.length;e++)this.contentItems[e].element.style.width=t9(t.width),this.contentItems[e].element.style.height=t9(t.height);this.emit("resize"),this.emitStateChangedEvent()}}highlightHeaderDropZone(t){let e;let i=this._header.lastVisibleTabIndex+1,n=this._header.tabsContainerElement.childNodes,o=Array(i),s=0,r=0;for(;r<i;){let t=n[s++];t!==this.layoutManager.tabDropPlaceholder&&(o[r++]=t)}let a=this.layoutManager.dropTargetIndicator;if(null===a)throw new t0("SHHDZDTI97110");if(0===i){let t=this._header.element.getBoundingClientRect(),i=t.top+document.body.scrollTop,n=t.left+document.body.scrollLeft;e={x1:n,x2:n+100,y1:i+t.height-20,y2:i+t.height},this._dropIndex=0}else{let n,s,r,a,l=0,h=!1;do{let e=(a=o[l]).getBoundingClientRect(),i=e.top+document.body.scrollTop,d=e.left+document.body.scrollLeft;this._header.leftRightSided?(s=i,n=d,r=e.height):(s=d,n=i,r=e.width),t>=s&&t<s+r?h=!0:l++}while(l<i&&!h);if(!1===h&&t<s)return;t<s+r/2?(this._dropIndex=l,a.insertAdjacentElement("beforebegin",this.layoutManager.tabDropPlaceholder)):(this._dropIndex=Math.min(l+1,i),a.insertAdjacentElement("afterend",this.layoutManager.tabDropPlaceholder));let d=this.layoutManager.tabDropPlaceholder.getBoundingClientRect(),m=d.top+document.body.scrollTop,c=d.left+document.body.scrollLeft,u=d.width;e=this._header.leftRightSided?{x1:n,x2:n+a.clientHeight,y1:m,y2:m+u}:{x1:c,x2:c+u,y1:n,y2:n+a.clientHeight}}a.highlightArea(e,0)}resetHeaderDropZone(){this.layoutManager.tabDropPlaceholder.remove()}setupHeaderPosition(){t6(this._header.element,this._header.show),this.element.classList.remove("lm_left","lm_right","lm_bottom"),this._header.leftRightSided&&this.element.classList.add("lm_"+this._header.side),this.updateSize(!1)}highlightBodyDropZone(t){if(void 0===this._contentAreaDimensions)throw new t1("SHBDZC82265");{let e=this._contentAreaDimensions[t].highlightArea,i=this.layoutManager.dropTargetIndicator;if(null===i)throw new t0("SHBDZD96110");i.highlightArea(e,1),this._dropSegment=t}}handleResize(){"block"===getComputedStyle(this.layoutManager.container).display&&this._header.updateTabSizes()}handleMaximised(){this._header.processMaximised()}handleMinimised(){this._header.processMinimised()}handlePopoutEvent(){this.popout()}handleHeaderClickEvent(t){let e=er.headerClickEventName,i=new er.ClickBubblingEvent(e,this,t);this.emit(e,i)}handleHeaderTouchStartEvent(t){let e=er.headerTouchStartEventName,i=new er.TouchStartBubblingEvent(e,this,t);this.emit(e,i)}handleHeaderComponentRemoveEvent(t){this.removeChild(t,!1)}handleHeaderComponentFocusEvent(t){this.setActiveComponentItem(t,!0)}handleHeaderComponentStartDragEvent(t,e,i,n){!0===this.isMaximised&&this.toggleMaximise(),this.layoutManager.startComponentDrag(t,e,i,n,this)}createHeaderConfig(){if(this._headerSideChanged){let t=!!this._header.show&&this._header.side,e=W.Header.createCopy(this._headerConfig,t);return void 0===e&&(e={show:t,popout:void 0,maximise:void 0,close:void 0,minimise:void 0,tabDropdown:void 0}),e}return W.Header.createCopy(this._headerConfig)}emitStateChangedEvent(){this.emitBaseBubblingEvent("stateChanged")}}(eC||(eC={})).createElement=function(t){let e=t.createElement("div");return e.classList.add("lm_item"),e.classList.add("lm_stack"),e};class ew extends er{constructor(t,e,i,n,o,s){if(super(),this._dragListener=i,this._layoutManager=n,this._componentItem=o,this._originalParent=s,this._area=null,this._lastValidArea=null,this._dragListener.on("drag",(t,e,i)=>this.onDrag(t,e,i)),this._dragListener.on("dragStop",()=>this.onDrop()),this.createDragProxyElements(t,e),null===this._componentItem.parent)throw new t0("DPC10097");this._componentItemFocused=this._componentItem.focused,this._componentItemFocused&&this._componentItem.blur(),this._componentItem.parent.removeChild(this._componentItem,!0),this.setDimensions(),document.body.appendChild(this._element),this.determineMinMaxXY(),this._layoutManager.calculateItemAreas(),this.setDropPosition(t,e)}get element(){return this._element}createDragProxyElements(t,e){this._element=document.createElement("div"),this._element.classList.add("lm_dragProxy");let i=document.createElement("div");i.classList.add("lm_header");let n=document.createElement("div");n.classList.add("lm_tabs");let o=document.createElement("div");o.classList.add("lm_tab");let s=document.createElement("span");s.classList.add("lm_title"),o.appendChild(s),n.appendChild(o),i.appendChild(n),this._proxyContainerElement=document.createElement("div"),this._proxyContainerElement.classList.add("lm_content"),this._element.appendChild(i),this._element.appendChild(this._proxyContainerElement),this._originalParent instanceof eC&&this._originalParent.headerShow&&(this._sided=this._originalParent.headerLeftRightSided,this._element.classList.add("lm_"+this._originalParent.headerSide),[A.right,A.bottom].indexOf(this._originalParent.headerSide)>=0&&this._proxyContainerElement.insertAdjacentElement("afterend",i)),this._element.style.left=t9(t),this._element.style.top=t9(e),o.setAttribute("title",this._componentItem.title),s.insertAdjacentText("afterbegin",this._componentItem.title),this._proxyContainerElement.appendChild(this._componentItem.element)}determineMinMaxXY(){let t=this._layoutManager.groundItem;if(void 0===t)throw new t1("DPDMMXY73109");{let e=t.element.getBoundingClientRect();this._minX=e.left+document.body.scrollLeft,this._minY=e.top+document.body.scrollTop,this._maxX=this._minX+e.width,this._maxY=this._minY+e.height}}onDrag(t,e,i){let n=i.pageX,o=i.pageY;this.setDropPosition(n,o),this._componentItem.drag()}setDropPosition(t,e){this._layoutManager.layoutConfig.settings.constrainDragToContainer&&(t<=this._minX?t=Math.ceil(this._minX):t>=this._maxX&&(t=Math.floor(this._maxX)),e<=this._minY?e=Math.ceil(this._minY):e>=this._maxY&&(e=Math.floor(this._maxY))),this._element.style.left=t9(t),this._element.style.top=t9(e),this._area=this._layoutManager.getArea(t,e),null!==this._area&&(this._lastValidArea=this._area,this._area.contentItem.highlightDropZone(t,e,this._area))}onDrop(){let t;let e=this._layoutManager.dropTargetIndicator;if(null===e)throw new t0("DPOD30011");(e.hide(),this._componentItem.exitDragMode(),null!==this._area)?(t=this._componentItem,this._area.contentItem.onDrop(t,this._area)):null!==this._lastValidArea?(t=this._componentItem,this._lastValidArea.contentItem.onDrop(t,this._lastValidArea)):this._originalParent?(t=this._componentItem,this._originalParent.addChild(t)):this._componentItem.destroy(),this._element.remove(),this._layoutManager.emit("itemDropped",this._componentItem),this._componentItemFocused&&void 0!==t&&t.focus()}setDimensions(){let t=this._layoutManager.layoutConfig.dimensions;if(void 0===t)throw Error("DragProxy.setDimensions: dimensions undefined");let e=t.dragProxyWidth,i=t.dragProxyHeight;if(void 0===e||void 0===i)throw Error("DragProxy.setDimensions: width and/or height undefined");let n=!1===this._layoutManager.layoutConfig.header.show?0:t.headerHeight;this._element.style.width=t9(e),this._element.style.height=t9(i),e-=this._sided?n:0,i-=this._sided?0:n,this._proxyContainerElement.style.width=t9(e),this._proxyContainerElement.style.height=t9(i),this._componentItem.enterDragMode(e,i),this._componentItem.show()}}class eI{constructor(t,e,i,n,o,s,r){this._layoutManager=t,this._element=e,this._extraAllowableChildTargets=i,this._componentTypeOrFtn=n,this._componentState=o,this._title=s,this._id=r,this._dragListener=null,this._dummyGroundContainer=document.createElement("div");let a=N.createDefault("row");this._dummyGroundContentItem=new eg(this._layoutManager,a,this._dummyGroundContainer),this.createDragListener()}destroy(){this.removeDragListener()}createDragListener(){this.removeDragListener(),this._dragListener=new ec(this._element,this._extraAllowableChildTargets),this._dragListener.on("dragStart",(t,e)=>this.onDragStart(t,e)),this._dragListener.on("dragStop",()=>this.onDragStop())}onDragStart(t,e){var i;let n;let o="component";if("function"==typeof this._componentTypeOrFtn){let t=this._componentTypeOrFtn();n=eI.isDragSourceComponentItemConfig(t)?{type:o,componentState:t.state,componentType:t.type,title:null!==(i=t.title)&&void 0!==i?i:this._title}:t}else n={type:o,componentState:this._componentState,componentType:this._componentTypeOrFtn,title:this._title,id:this._id};let s=K.resolve(n,!1),r=new ed(this._layoutManager,s,this._dummyGroundContentItem);if(this._dummyGroundContentItem.contentItems.push(r),null===this._dragListener)throw new t0("DSODSD66746");{let i=new ew(t,e,this._dragListener,this._layoutManager,r,this._dummyGroundContentItem),n=this._layoutManager.transitionIndicator;if(null===n)throw new t0("DSODST66746");n.transitionElements(this._element,i.element)}}onDragStop(){this.createDragListener()}removeDragListener(){null!==this._dragListener&&(this._dragListener.destroy(),this._dragListener=null)}}(eI||(eI={})).isDragSourceComponentItemConfig=function(t){return!("componentType"in t)};class eb{constructor(){this._element=document.createElement("div"),this._element.classList.add("lm_dropTargetIndicator");let t=document.createElement("div");t.classList.add("lm_inner"),this._element.appendChild(t),document.body.appendChild(this._element)}destroy(){this._element.remove()}highlightArea(t,e){this._element.style.left=t9(t.x1+e),this._element.style.top=t9(t.y1+e),this._element.style.width=t9(t.x2-t.x1-e),this._element.style.height=t9(t.y2-t.y1-e),this._element.style.display="block"}hide(){t6(this._element,!1)}}class eS{constructor(){this._element=document.createElement("div"),this._element.classList.add("lm_transition_indicator"),document.body.appendChild(this._element),this._toElement=null,this._fromDimensions=null,this._totalAnimationDuration=200,this._animationStartTime=null}destroy(){this._element.remove()}transitionElements(t,e){}nextAnimationFrame(){}measure(t){let e=t.getBoundingClientRect();return{left:e.left,top:e.top,width:t.offsetWidth,height:t.offsetHeight}}}class eE extends er{constructor(t){super(),this._layoutManager=t,this._childEventListener=t=>this.onEventFromChild(t),globalThis.addEventListener(eE.ChildEventName,this._childEventListener,{passive:!0})}emit(t,...e){"userBroadcast"===t?this.emitUserBroadcast(...e):super.emit(t,...e)}emitUserBroadcast(...t){this.handleUserBroadcastEvent("userBroadcast",t)}destroy(){globalThis.removeEventListener(eE.ChildEventName,this._childEventListener)}handleUserBroadcastEvent(t,e){this._layoutManager.isSubWindow?this.propagateToParent(t,e):this.propagateToThisAndSubtree(t,e)}onEventFromChild(t){let e=t.detail;this.handleUserBroadcastEvent(e.eventName,e.args)}propagateToParent(t,e){let i={bubbles:!0,cancelable:!0,detail:{layoutManager:this._layoutManager,eventName:t,args:e}},n=new CustomEvent(eE.ChildEventName,i),o=globalThis.opener;if(null===o)throw new t0("EHPTP15778");o.dispatchEvent(n)}propagateToThisAndSubtree(t,e){this.emitUnknown(t,...e);for(let i=0;i<this._layoutManager.openPopouts.length;i++){let n=this._layoutManager.openPopouts[i].getGlInstance();n&&n.eventHub.propagateToThisAndSubtree(t,e)}}}(eE||(eE={})).ChildEventName="gl_child_event";class ex extends er{constructor(t){super(),this.resizeWithContainerAutomatically=!1,this.resizeDebounceInterval=100,this.resizeDebounceExtendedWhenPossible=!0,this._isInitialised=!1,this._groundItem=void 0,this._openPopouts=[],this._dropTargetIndicator=null,this._transitionIndicator=null,this._itemAreas=[],this._maximisePlaceholder=ex.createMaximisePlaceElement(document),this._tabDropPlaceholder=ex.createTabDropPlaceholderElement(document),this._dragSources=[],this._updatingColumnsResponsive=!1,this._firstLoad=!0,this._eventHub=new eE(this),this._width=null,this._height=null,this._virtualSizedContainers=[],this._virtualSizedContainerAddingBeginCount=0,this._sizeInvalidationBeginCount=0,this._resizeObserver=new ResizeObserver(()=>this.handleContainerResize()),this._windowBeforeUnloadListener=()=>this.onBeforeUnload(),this._windowBeforeUnloadListening=!1,this._maximisedStackBeforeDestroyedListener=t=>this.cleanupBeforeMaximisedStackDestroyed(t),this.isSubWindow=t.isSubWindow,this._constructorOrSubWindowLayoutConfig=t.constructorOrSubWindowLayoutConfig,M.checkInitialise(),O.checkInitialise(),void 0!==t.containerElement&&(this._containerElement=t.containerElement)}get container(){return this._containerElement}get isInitialised(){return this._isInitialised}get groundItem(){return this._groundItem}get root(){return this._groundItem}get openPopouts(){return this._openPopouts}get dropTargetIndicator(){return this._dropTargetIndicator}get transitionIndicator(){return this._transitionIndicator}get width(){return this._width}get height(){return this._height}get eventHub(){return this._eventHub}get rootItem(){if(void 0===this._groundItem)throw Error("Cannot access rootItem before init");return 0===this._groundItem.contentItems.length?void 0:this._groundItem.contentItems[0]}get focusedComponentItem(){return this._focusedComponentItem}get tabDropPlaceholder(){return this._tabDropPlaceholder}get maximisedStack(){return this._maximisedStack}get deprecatedConstructor(){return!this.isSubWindow&&void 0!==this._constructorOrSubWindowLayoutConfig}destroy(){if(this._isInitialised){for(let t of(this._windowBeforeUnloadListening&&(globalThis.removeEventListener("beforeunload",this._windowBeforeUnloadListener),this._windowBeforeUnloadListening=!1),!0===this.layoutConfig.settings.closePopoutsOnUnload&&this.closeAllOpenPopouts(),this._resizeObserver.disconnect(),this.checkClearResizeTimeout(),void 0!==this._groundItem&&this._groundItem.destroy(),this._tabDropPlaceholder.remove(),null!==this._dropTargetIndicator&&this._dropTargetIndicator.destroy(),null!==this._transitionIndicator&&this._transitionIndicator.destroy(),this._eventHub.destroy(),this._dragSources))t.destroy();this._dragSources=[],this._isInitialised=!1}}minifyConfig(t){return G.minifyConfig(t)}unminifyConfig(t){return G.unminifyConfig(t)}init(){let t;if(this.setContainer(),this._dropTargetIndicator=new eb,this._transitionIndicator=new eS,this.updateSizeFromContainer(),this.isSubWindow){if(void 0===this._constructorOrSubWindowLayoutConfig)throw new t1("LMIU07155");{let e=this._constructorOrSubWindowLayoutConfig.root;if(void 0===e)throw new tJ("LMIC07156");if(!q.isComponent(e))throw new tJ("LMIC07157");t=e;let i=tt.resolve(this._constructorOrSubWindowLayoutConfig);this.layoutConfig=Object.assign(Object.assign({},i),{root:void 0})}}else void 0===this._constructorOrSubWindowLayoutConfig?this.layoutConfig=G.createDefault():this.layoutConfig=tt.resolve(this._constructorOrSubWindowLayoutConfig);let e=this.layoutConfig;this._groundItem=new eg(this,e.root,this._containerElement),this._groundItem.init(),this.checkLoadedLayoutMaximiseItem(),this._resizeObserver.observe(this._containerElement),this._isInitialised=!0,this.adjustColumnsResponsive(),this.emit("initialised"),void 0!==t&&this.loadComponentAsRoot(t)}loadLayout(t){if(!this.isInitialised)throw Error("GoldenLayout: Need to call init() if LayoutConfig with defined root passed to constructor");if(void 0===this._groundItem)throw new t1("LMLL11119");this.createSubWindows(),this.layoutConfig=tt.resolve(t),this._groundItem.loadRoot(this.layoutConfig.root),this.checkLoadedLayoutMaximiseItem(),this.adjustColumnsResponsive()}saveLayout(){if(!1===this._isInitialised)throw Error("Can't create config, layout not yet initialised");if(void 0===this._groundItem)throw new t1("LMTC18244");{let t;let e=this._groundItem.calculateConfigContent();t=1!==e.length?void 0:e[0],this.reconcilePopoutWindows();let i=[];for(let t=0;t<this._openPopouts.length;t++)i.push(this._openPopouts[t].toConfig());return{root:t,openPopouts:i,settings:G.Settings.createCopy(this.layoutConfig.settings),dimensions:G.Dimensions.createCopy(this.layoutConfig.dimensions),header:G.Header.createCopy(this.layoutConfig.header),resolved:!0}}}clear(){if(void 0===this._groundItem)throw new t1("LMCL11129");this._groundItem.clearRoot()}toConfig(){return this.saveLayout()}newComponent(t,e,i){let n=this.newComponentAtLocation(t,e,i);if(void 0===n)throw new tJ("LMNC65588");return n}newComponentAtLocation(t,e,i,n){if(void 0===this._groundItem)throw Error("Cannot add component before init");{let o=this.addComponentAtLocation(t,e,i,n);if(void 0===o)return;{let t=o.parentItem.contentItems[o.index];if(eh.isComponentItem(t))return t;throw new tJ("LMNC992877533")}}}addComponent(t,e,i){let n=this.addComponentAtLocation(t,e,i);if(void 0===n)throw new tJ("LMAC99943");return n}addComponentAtLocation(t,e,i,n){return this.addItemAtLocation({type:"component",componentType:t,componentState:e,title:i},n)}newItem(t){let e=this.newItemAtLocation(t);if(void 0===e)throw new tJ("LMNC65588");return e}newItemAtLocation(t,e){if(void 0===this._groundItem)throw Error("Cannot add component before init");{let i=this.addItemAtLocation(t,e);if(void 0===i)return;return i.parentItem.contentItems[i.index]}}addItem(t){let e=this.addItemAtLocation(t);if(void 0===e)throw new tJ("LMAI99943");return e}addItemAtLocation(t,e){if(void 0===this._groundItem)throw Error("Cannot add component before init");{void 0===e&&(e="component"===t.type?ex.defaultLocationSelectors:ex.defaultNonComponentSelectors);let i=this.findFirstLocation(e);if(void 0===i)return;{let e,n=i.parentItem;switch(n.type){case R.ground:(e=n.addItem(t,i.index))>=0?n=this._groundItem.contentItems[0]:e=0;break;case R.row:case R.column:e=n.addItem(t,i.index);break;case R.stack:if(q.isComponent(t)){e=n.addItem(t,i.index);break}throw Error(t2[6]);case R.component:throw new tJ("LMAIALC87444602");default:throw new tQ("LMAIALU98881733",n.type)}if(q.isComponent(t)){let t=n.contentItems[e];eh.isStack(t)&&(n=t,e=0)}return i.parentItem=n,i.index=e,i}}}loadComponentAsRoot(t){if(void 0===this._groundItem)throw Error("Cannot add item before init");this._groundItem.loadComponentAsRoot(t)}updateSize(t,e){this.setSize(t,e)}setSize(t,e){if(this._width=t,this._height=e,!0===this._isInitialised){if(void 0===this._groundItem)throw new t1("LMUS18881");if(this._groundItem.setSize(this._width,this._height),this._maximisedStack){let{width:t,height:e}=t4(this._containerElement);t7(this._maximisedStack.element,t),t8(this._maximisedStack.element,e),this._maximisedStack.updateSize(!1)}this.adjustColumnsResponsive()}}beginSizeInvalidation(){this._sizeInvalidationBeginCount++}endSizeInvalidation(){0==--this._sizeInvalidationBeginCount&&this.updateSizeFromContainer()}updateSizeFromContainer(){let{width:t,height:e}=t4(this._containerElement);this.setSize(t,e)}updateRootSize(t=!1){if(void 0===this._groundItem)throw new t1("LMURS28881");this._groundItem.updateSize(t)}createAndInitContentItem(t,e){let i=this.createContentItem(t,e);return i.init(),i}createContentItem(t,e){if("string"!=typeof t.type)throw new tZ("Missing parameter 'type'",JSON.stringify(t));return!B.isComponentItem(t)||e instanceof eC||!e||!0===this.isSubWindow&&e instanceof eg||(t={type:R.stack,content:[t],size:t.size,sizeUnit:t.sizeUnit,minSize:t.minSize,minSizeUnit:t.minSizeUnit,id:t.id,maximised:t.maximised,isClosable:t.isClosable,activeItemIndex:0,header:void 0}),this.createContentItemFromConfig(t,e)}findFirstComponentItemById(t){if(void 0===this._groundItem)throw new t1("LMFFCIBI82446");return this.findFirstContentItemTypeByIdRecursive(R.component,t,this._groundItem)}createPopout(t,e,i,n){return t instanceof eh?this.createPopoutFromContentItem(t,e,i,n):this.createPopoutFromItemConfig(t,e,i,n)}createPopoutFromContentItem(t,e,i,n){let o=t.parent,s=t;for(;null!==o&&1===o.contentItems.length&&!o.isGround;)s=o,o=o.parent;if(null===o)throw new t0("LMCPFCI00834");{if(void 0===n&&(n=o.contentItems.indexOf(s)),null!==i&&o.addPopInParentId(i),void 0===e){let i=globalThis.screenX||globalThis.screenLeft,n=globalThis.screenY||globalThis.screenTop,o=t.element.offsetLeft,s=t.element.offsetTop,{width:r,height:a}=t4(t.element);e={left:i+o,top:n+s,width:r,height:a}}let r=t.toConfig();if(t.remove(),$.isRootItemConfig(r))return this.createPopoutFromItemConfig(r,e,i,n);throw Error(`${t2[0]}`)}}beginVirtualSizedContainerAdding(){0==++this._virtualSizedContainerAddingBeginCount&&(this._virtualSizedContainers.length=0)}addVirtualSizedContainer(t){this._virtualSizedContainers.push(t)}endVirtualSizedContainerAdding(){if(0==--this._virtualSizedContainerAddingBeginCount){let t=this._virtualSizedContainers.length;if(t>0){this.fireBeforeVirtualRectingEvent(t);for(let e=0;e<t;e++)this._virtualSizedContainers[e].notifyVirtualRectingRequired();this.fireAfterVirtualRectingEvent(),this._virtualSizedContainers.length=0}}}fireBeforeVirtualRectingEvent(t){void 0!==this.beforeVirtualRectingEvent&&this.beforeVirtualRectingEvent(t)}fireAfterVirtualRectingEvent(){void 0!==this.afterVirtualRectingEvent&&this.afterVirtualRectingEvent()}createPopoutFromItemConfig(t,e,i,n){let o=this.toConfig(),s={root:t,openPopouts:[],settings:o.settings,dimensions:o.dimensions,header:o.header,window:e,parentId:i,indexInParent:n,resolved:!0};return this.createPopoutFromPopoutLayoutConfig(s)}createPopoutFromPopoutLayoutConfig(t){var e,i,n,o;let s=t.window,r=new el(t,{left:null!==(e=s.left)&&void 0!==e?e:globalThis.screenX||globalThis.screenLeft+20,top:null!==(i=s.top)&&void 0!==i?i:globalThis.screenY||globalThis.screenTop+20,width:null!==(n=s.width)&&void 0!==n?n:500,height:null!==(o=s.height)&&void 0!==o?o:309},this);return r.on("initialised",()=>this.emit("windowOpened",r)),r.on("closed",()=>this.reconcilePopoutWindows()),this._openPopouts.push(r),this.layoutConfig.settings.closePopoutsOnUnload&&!this._windowBeforeUnloadListening&&(globalThis.addEventListener("beforeunload",this._windowBeforeUnloadListener,{passive:!0}),this._windowBeforeUnloadListening=!0),r}closeAllOpenPopouts(){for(let t=0;t<this._openPopouts.length;t++)this._openPopouts[t].close();this._openPopouts.length=0,this._windowBeforeUnloadListening&&(globalThis.removeEventListener("beforeunload",this._windowBeforeUnloadListener),this._windowBeforeUnloadListening=!1)}newDragSource(t,e,i,n,o){let s=new eI(this,t,[],e,i,n,o);return this._dragSources.push(s),s}removeDragSource(t){!function(t,e){let i=e.indexOf(t);if(-1===i)throw Error("Can't remove item from array. Item is not in the array");e.splice(i,1)}(t,this._dragSources),t.destroy()}startComponentDrag(t,e,i,n,o){new ew(t,e,i,this,n,o)}focusComponent(t,e=!1){t.focus(e)}clearComponentFocus(t=!1){this.setFocusedComponentItem(void 0,t)}setFocusedComponentItem(t,e=!1){if(t!==this._focusedComponentItem){let i;if(void 0===t||(i=t.parentItem),void 0!==this._focusedComponentItem){let t=this._focusedComponentItem;this._focusedComponentItem=void 0,t.setBlurred(e);let n=t.parentItem;i===n?i=void 0:n.setFocusedValue(!1)}void 0!==t&&(this._focusedComponentItem=t,t.setFocused(e),void 0!==i&&i.setFocusedValue(!0))}}createContentItemFromConfig(t,e){switch(t.type){case R.ground:throw new tJ("LMCCIFC68871");case R.row:return new ep(!1,this,t,e);case R.column:return new ep(!0,this,t,e);case R.stack:return new eC(this,t,e);case R.component:return new ed(this,t,e);default:throw new tQ("CCC913564",t.type,"Invalid Config Item type specified")}}setMaximisedStack(t){void 0===t?void 0!==this._maximisedStack&&this.processMinimiseMaximisedStack():t!==this._maximisedStack&&(void 0!==this._maximisedStack&&this.processMinimiseMaximisedStack(),this.processMaximiseStack(t))}checkMinimiseMaximisedStack(){void 0!==this._maximisedStack&&this._maximisedStack.minimise()}cleanupBeforeMaximisedStackDestroyed(t){null!==this._maximisedStack&&this._maximisedStack===t.target&&(this._maximisedStack.off("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),this._maximisedStack=void 0)}closeWindow(){globalThis.setTimeout(()=>globalThis.close(),1)}getArea(t,e){let i=null,n=1/0;for(let o=0;o<this._itemAreas.length;o++){let s=this._itemAreas[o];t>=s.x1&&t<s.x2&&e>=s.y1&&e<s.y2&&n>s.surface&&(n=s.surface,i=s)}return i}calculateItemAreas(){let t=this.getAllContentItems(),e=this._groundItem;if(void 0===e)throw new t1("LMCIAR44365");if(1!==t.length){e.contentItems[0].isStack?this._itemAreas=[]:this._itemAreas=e.createSideAreas();for(let e=0;e<t.length;e++){let i=t[e];if(eh.isStack(i)){let t=i.getArea();if(null===t)continue;{this._itemAreas.push(t);let e=i.contentAreaDimensions;if(void 0===e)throw new t1("LMCIASC45599");{let t=e.header.highlightArea,n=(t.x2-t.x1)*(t.y2-t.y1),o={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,contentItem:i,surface:n};this._itemAreas.push(o)}}}}}else{let t=e.getElementArea();if(null===t)throw new t0("LMCIARA44365");this._itemAreas=[t]}}checkLoadedLayoutMaximiseItem(){if(void 0===this._groundItem)throw new t1("LMCLLMI43432");{let t=this._groundItem.getConfigMaximisedItems();if(t.length>0){let e=t[0];if(eh.isComponentItem(e)){let t=e.parent;if(null===t)throw new t0("LMXLLMI69999");e=t}if(!eh.isStack(e))throw new tJ("LMCLLMI19993");e.maximise()}}}processMaximiseStack(t){if(this._maximisedStack=t,t.on("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),t.element.classList.add("lm_maximised"),t.element.insertAdjacentElement("afterend",this._maximisePlaceholder),void 0===this._groundItem)throw new t1("LMMXI19993");{this._groundItem.element.prepend(t.element);let{width:e,height:i}=t4(this._containerElement);t7(t.element,e),t8(t.element,i),t.updateSize(!0),t.focusActiveContentItem(),this._maximisedStack.emit("maximised"),this.emit("stateChanged")}}processMinimiseMaximisedStack(){if(void 0===this._maximisedStack)throw new tJ("LMMMS74422");{let t=this._maximisedStack;if(null===t.parent)throw new t0("LMMI13668");t.element.classList.remove("lm_maximised"),this._maximisePlaceholder.insertAdjacentElement("afterend",t.element),this._maximisePlaceholder.remove(),this.updateRootSize(!0),this._maximisedStack=void 0,t.off("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),t.emit("minimised"),this.emit("stateChanged")}}reconcilePopoutWindows(){let t=[];for(let e=0;e<this._openPopouts.length;e++)!1===this._openPopouts[e].getWindow().closed?t.push(this._openPopouts[e]):this.emit("windowClosed",this._openPopouts[e]);this._openPopouts.length!==t.length&&(this._openPopouts=t,this.emit("stateChanged"))}getAllContentItems(){if(void 0===this._groundItem)throw new t1("LMGACI13130");return this._groundItem.getAllContentItems()}createSubWindows(){for(let t=0;t<this.layoutConfig.openPopouts.length;t++){let e=this.layoutConfig.openPopouts[t];this.createPopoutFromPopoutLayoutConfig(e)}}handleContainerResize(){this.resizeWithContainerAutomatically&&this.processResizeWithDebounce()}processResizeWithDebounce(){this.resizeDebounceExtendedWhenPossible&&this.checkClearResizeTimeout(),void 0===this._resizeTimeoutId&&(this._resizeTimeoutId=setTimeout(()=>{this._resizeTimeoutId=void 0,this.beginSizeInvalidation(),this.endSizeInvalidation()},this.resizeDebounceInterval))}checkClearResizeTimeout(){void 0!==this._resizeTimeoutId&&(clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=void 0)}setContainer(){var t;let e=document.body,i=null!==(t=this._containerElement)&&void 0!==t?t:e;if(i===e){this.resizeWithContainerAutomatically=!0;let t=document.documentElement;t.style.height="100%",t.style.margin="0",t.style.padding="0",t.style.overflow="clip",e.style.height="100%",e.style.margin="0",e.style.padding="0",e.style.overflow="clip"}this._containerElement=i}onBeforeUnload(){this.destroy()}adjustColumnsResponsive(){if(void 0===this._groundItem)throw new t1("LMACR20883");if(this._firstLoad=!1,this.useResponsiveLayout()&&!this._updatingColumnsResponsive&&this._groundItem.contentItems.length>0&&this._groundItem.contentItems[0].isRow){if(void 0===this._groundItem||null===this._width)throw new t1("LMACR77412");{let t=this._groundItem.contentItems[0].contentItems.length;if(t<=1)return;{let e=this.layoutConfig.dimensions.defaultMinItemWidth;if(t*e<=this._width)return;{this._updatingColumnsResponsive=!0;let i=t-Math.max(Math.floor(this._width/e),1),n=this._groundItem.contentItems[0],o=this.getAllStacks();if(0===o.length)throw new tJ("LMACRS77413");{let t=o[0];for(let e=0;e<i;e++){let e=n.contentItems[n.contentItems.length-1];this.addChildContentItemsToContainer(t,e)}this._updatingColumnsResponsive=!1}}}}}}useResponsiveLayout(){let t=this.layoutConfig.settings,e=t.responsiveMode===U.always,i=t.responsiveMode===U.onload&&this._firstLoad;return e||i}addChildContentItemsToContainer(t,e){let i=e.contentItems;if(e instanceof eC)for(let n=0;n<i.length;n++){let o=i[n];e.removeChild(o,!0),t.addChild(o)}else for(let e=0;e<i.length;e++){let n=i[e];this.addChildContentItemsToContainer(t,n)}}getAllStacks(){if(void 0===this._groundItem)throw new t1("LMFASC52778");{let t=[];return this.findAllStacksRecursive(t,this._groundItem),t}}findFirstContentItemType(t){if(void 0===this._groundItem)throw new t1("LMFFCIT82446");return this.findFirstContentItemTypeRecursive(t,this._groundItem)}findFirstContentItemTypeRecursive(t,e){let i=e.contentItems,n=i.length;if(0!==n){for(let e=0;e<n;e++){let n=i[e];if(n.type===t)return n}for(let e=0;e<n;e++){let n=i[e],o=this.findFirstContentItemTypeRecursive(t,n);if(void 0!==o)return o}}}findFirstContentItemTypeByIdRecursive(t,e,i){let n=i.contentItems,o=n.length;if(0!==o){for(let i=0;i<o;i++){let o=n[i];if(o.type===t&&o.id===e)return o}for(let i=0;i<o;i++){let o=n[i],s=this.findFirstContentItemTypeByIdRecursive(t,e,o);if(void 0!==s)return s}}}findAllStacksRecursive(t,e){let i=e.contentItems;for(let e=0;e<i.length;e++){let n=i[e];n instanceof eC?t.push(n):n.isComponent||this.findAllStacksRecursive(t,n)}}findFirstLocation(t){let e=t.length;for(let i=0;i<e;i++){let e=t[i],n=this.findLocation(e);if(void 0!==n)return n}}findLocation(t){let e=t.index;switch(t.typeId){case 0:if(void 0===this._focusedComponentItem)return;{let t=this._focusedComponentItem.parentItem,i=t.contentItems,n=i.length;if(void 0===e)return{parentItem:t,index:n};{let o=i.indexOf(this._focusedComponentItem)+e;return o<0||o>n?void 0:{parentItem:t,index:o}}}case 1:if(void 0===this._focusedComponentItem)return;{let t=this._focusedComponentItem.parentItem;return this.tryCreateLocationFromParentItem(t,e)}case 2:{let t=this.findFirstContentItemType(R.stack);return void 0===t?void 0:this.tryCreateLocationFromParentItem(t,e)}case 3:{let t=this.findFirstContentItemType(R.row);return void 0!==t?this.tryCreateLocationFromParentItem(t,e):void 0!==(t=this.findFirstContentItemType(R.column))?this.tryCreateLocationFromParentItem(t,e):void 0}case 4:{let t=this.findFirstContentItemType(R.row);return void 0===t?void 0:this.tryCreateLocationFromParentItem(t,e)}case 5:{let t=this.findFirstContentItemType(R.column);return void 0===t?void 0:this.tryCreateLocationFromParentItem(t,e)}case 6:if(void 0===this._groundItem)throw new t1("LMFLRIF18244");return void 0!==this.rootItem?void 0:void 0===e||0===e?{parentItem:this._groundItem,index:0}:void 0;case 7:if(void 0===this._groundItem)throw new t1("LMFLF18244");{let t=this._groundItem.contentItems;if(0===t.length)return void 0===e||0===e?{parentItem:this._groundItem,index:0}:void 0;{let i=t[0];return this.tryCreateLocationFromParentItem(i,e)}}}}tryCreateLocationFromParentItem(t,e){let i=t.contentItems.length;return void 0===e?{parentItem:t,index:i}:e<0||e>i?void 0:{parentItem:t,index:e}}}(L=ex||(ex={})).createMaximisePlaceElement=function(t){let e=t.createElement("div");return e.classList.add("lm_maximise_place"),e},L.createTabDropPlaceholderElement=function(t){let e=t.createElement("div");return e.classList.add("lm_drop_tab_placeholder"),e},L.defaultNonComponentSelectors=[{typeId:3,index:void 0},{typeId:7,index:void 0}],L.defaultLocationSelectors=[{typeId:1,index:void 0},{typeId:2,index:void 0},...L.defaultNonComponentSelectors],L.afterFocusedItemIfPossibleLocationSelectors=[{typeId:0,index:1},{typeId:2,index:void 0},{typeId:3,index:void 0},{typeId:7,index:void 0}];class eL extends ex{constructor(t,e,i,n){if(super(eL.createLayoutManagerConstructorParameters(t,e)),this._bindComponentEventHanlderPassedInConstructor=!1,this._creationTimeoutPassed=!1,void 0!==e&&"function"==typeof e&&(this.bindComponentEvent=e,this._bindComponentEventHanlderPassedInConstructor=!0,void 0!==i&&(this.unbindComponentEvent=i)),!this._bindComponentEventHanlderPassedInConstructor&&this.isSubWindow){if(void 0===this._constructorOrSubWindowLayoutConfig)throw new t1("VLC98823");{let t=tt.resolve(this._constructorOrSubWindowLayoutConfig);this.layoutConfig=Object.assign(Object.assign({},t),{root:void 0})}}!0!==n&&(this.deprecatedConstructor||this.init())}destroy(){this.bindComponentEvent=void 0,this.unbindComponentEvent=void 0,super.destroy()}init(){if(this._bindComponentEventHanlderPassedInConstructor||"loading"!==document.readyState&&null!==document.body){if(!this._bindComponentEventHanlderPassedInConstructor&&!0===this.isSubWindow&&!this._creationTimeoutPassed)return setTimeout(()=>this.init(),7),void(this._creationTimeoutPassed=!0);!0===this.isSubWindow&&(this._bindComponentEventHanlderPassedInConstructor||this.clearHtmlAndAdjustStylesForSubWindow(),window.__glInstance=this),super.init()}else document.addEventListener("DOMContentLoaded",()=>this.init(),{passive:!0})}clearHtmlAndAdjustStylesForSubWindow(){let t=document.head,e=[,,,,];e[0]=document.querySelectorAll("body link"),e[1]=document.querySelectorAll("body style"),e[2]=document.querySelectorAll("template"),e[3]=document.querySelectorAll(".gl_keep");for(let i=0;i<e.length;i++){let n=e[i];for(let e=0;e<n.length;e++){let i=n[e];t.appendChild(i)}}let i=document.body;i.innerHTML="",i.style.visibility="visible",this.checkAddDefaultPopinButton(),document.body.offsetHeight}checkAddDefaultPopinButton(){if(this.layoutConfig.settings.popInOnClose)return!1;{let t=document.createElement("div");t.classList.add("lm_popin"),t.setAttribute("title",this.layoutConfig.header.dock);let e=document.createElement("div");e.classList.add("lm_icon");let i=document.createElement("div");return i.classList.add("lm_bg"),t.appendChild(e),t.appendChild(i),t.addEventListener("click",()=>this.emit("popIn")),document.body.appendChild(t),!0}}bindComponent(t,e){if(void 0!==this.bindComponentEvent)return this.bindComponentEvent(t,e);if(void 0!==this.getComponentEvent)return{virtual:!1,component:this.getComponentEvent(t,e)};throw new tY(`${t2[2]}: ${JSON.stringify(e)}`)}unbindComponent(t,e,i){if(void 0!==this.unbindComponentEvent)this.unbindComponentEvent(t);else if(!e&&void 0!==this.releaseComponentEvent){if(void 0===i)throw new t1("VCUCRCU333998");this.releaseComponentEvent(t,i)}}}z=eL||(eL={}),n=!1,z.createLayoutManagerConstructorParameters=function(t,e){let i,o;let s=n?null:new URL(document.location.href).searchParams.get("gl-window");n=!0;let r=null!==s;if(null!==s){let e=localStorage.getItem(s);if(null===e)throw Error("Null gl-window Config");localStorage.removeItem(s);let n=JSON.parse(e),r=G.unminifyConfig(n);o=tt.fromResolved(r),t instanceof HTMLElement&&(i=t)}else void 0===t?o=void 0:t instanceof HTMLElement?(o=void 0,i=t):o=t,void 0===i&&e instanceof HTMLElement&&(i=e);return{constructorOrSubWindowLayoutConfig:o,isSubWindow:r,containerElement:i}};class ez extends eL{constructor(t,e,i){super(t,e,i,!0),this._componentTypesMap=new Map,this._registeredComponentMap=new Map,this._virtuableComponentMap=new Map,this._containerVirtualRectingRequiredEventListener=(t,e,i)=>this.handleContainerVirtualRectingRequiredEvent(t,e,i),this._containerVirtualVisibilityChangeRequiredEventListener=(t,e)=>this.handleContainerVirtualVisibilityChangeRequiredEvent(t,e),this._containerVirtualZIndexChangeRequiredEventListener=(t,e,i)=>this.handleContainerVirtualZIndexChangeRequiredEvent(t,e,i),this.deprecatedConstructor||this.init()}registerComponent(t,e,i=!1){if("function"!=typeof e)throw new tX("registerComponent() componentConstructorOrFactoryFtn parameter is not a function");e.hasOwnProperty("prototype")?this.registerComponentConstructor(t,e,i):this.registerComponentFactoryFunction(t,e,i)}registerComponentConstructor(t,e,i=!1){if("function"!=typeof e)throw Error(t2[1]);if(void 0!==this._componentTypesMap.get(t))throw new tY(`${t2[3]}: ${t}`);this._componentTypesMap.set(t,{constructor:e,factoryFunction:void 0,virtual:i})}registerComponentFactoryFunction(t,e,i=!1){if("function"!=typeof e)throw new tY("Please register a constructor function");if(void 0!==this._componentTypesMap.get(t))throw new tY(`${t2[3]}: ${t}`);this._componentTypesMap.set(t,{constructor:void 0,factoryFunction:e,virtual:i})}registerComponentFunction(t){this.registerGetComponentConstructorCallback(t)}registerGetComponentConstructorCallback(t){if("function"!=typeof t)throw Error("Please register a callback function");void 0!==this._getComponentConstructorFtn&&console.warn("Multiple component functions are being registered.  Only the final registered function will be used."),this._getComponentConstructorFtn=t}getRegisteredComponentTypeNames(){return Array.from(this._componentTypesMap.keys())}getComponentInstantiator(t){let e;let i=F.resolveComponentTypeName(t);return void 0!==i&&(e=this._componentTypesMap.get(i)),void 0===e&&void 0!==this._getComponentConstructorFtn&&(e={constructor:this._getComponentConstructorFtn(t),factoryFunction:void 0,virtual:!1}),e}bindComponent(t,e){let i,n;let o=F.resolveComponentTypeName(e);if(void 0!==o&&(i=this._componentTypesMap.get(o)),void 0===i&&void 0!==this._getComponentConstructorFtn&&(i={constructor:this._getComponentConstructorFtn(e),factoryFunction:void 0,virtual:!1}),void 0!==i){let s,r;let a=i.virtual;s=void 0===e.componentState?void 0:ee({},e.componentState);let l=i.constructor;if(void 0!==l)r=new l(t,s,a);else{let e=i.factoryFunction;if(void 0===e)throw new tJ("LMBCFFU10008");r=e(t,s,a)}if(a){if(void 0===r)throw new t1("GLBCVCU988774");{let e=r,i=e.rootHtmlElement;if(void 0===i)throw new tY(`${t2[5]}: ${o}`);!function(t){let e="absolute";t.style.position!==e&&(t.style.position=e)}(i),this.container.appendChild(i),this._virtuableComponentMap.set(t,e),t.virtualRectingRequiredEvent=this._containerVirtualRectingRequiredEventListener,t.virtualVisibilityChangeRequiredEvent=this._containerVirtualVisibilityChangeRequiredEventListener,t.virtualZIndexChangeRequiredEvent=this._containerVirtualZIndexChangeRequiredEventListener}}this._registeredComponentMap.set(t,r),n={virtual:i.virtual,component:r}}else n=super.bindComponent(t,e);return n}unbindComponent(t,e,i){if(void 0===this._registeredComponentMap.get(t))super.unbindComponent(t,e,i);else{let e=this._virtuableComponentMap.get(t);if(void 0!==e){let i=e.rootHtmlElement;if(void 0===i)throw new tJ("GLUC77743",t.title);this.container.removeChild(i),this._virtuableComponentMap.delete(t)}}}fireBeforeVirtualRectingEvent(t){this._goldenLayoutBoundingClientRect=this.container.getBoundingClientRect(),super.fireBeforeVirtualRectingEvent(t)}handleContainerVirtualRectingRequiredEvent(t,e,i){let n=this._virtuableComponentMap.get(t);if(void 0===n)throw new t1("GLHCSCE55933");{let o=n.rootHtmlElement;if(void 0===o)throw new tY(t2[4]+" "+t.title);{let n=t.element.getBoundingClientRect(),s=n.left-this._goldenLayoutBoundingClientRect.left;o.style.left=t9(s);let r=n.top-this._goldenLayoutBoundingClientRect.top;o.style.top=t9(r),t7(o,e),t8(o,i)}}}handleContainerVirtualVisibilityChangeRequiredEvent(t,e){let i=this._virtuableComponentMap.get(t);if(void 0===i)throw new t1("GLHCVVCRE55934");{let n=i.rootHtmlElement;if(void 0===n)throw new tY(t2[4]+" "+t.title);t6(n,e)}}handleContainerVirtualZIndexChangeRequiredEvent(t,e,i){let n=this._virtuableComponentMap.get(t);if(void 0===n)throw new t1("GLHCVZICRE55935");{let e=n.rootHtmlElement;if(void 0===e)throw new tY(t2[4]+" "+t.title);e.style.zIndex=i}}}let eM="initial_",eP={show:"top",popout:!1,close:"close-tab-unused"},eT={headerHeight:31},eA={hasHeaders:!0,reorderEnabled:!0,showMaximiseIcon:!1},ek={popoutWholeStack:!1,constrainDragToContainer:!1,constrainDragToHeaders:!1,preventDragout:!1,showPopoutIcon:!1,showCloseIcon:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,selectionEnabled:!1};class eD{constructor(t){this.layout=t,ti.set(this,void 0),tn.set(this,void 0),this.handleResize=t=>{t.forEach(t=>this.resizeElement(t.target))},this.handleMutation=()=>{this.layout.viewComponentsByContainerElement.forEach(t=>{this.resizeElement(t.container.element)})},(0,ta._)(this,ti,new ResizeObserver(this.handleResize),"f"),(0,ta._)(this,tn,new MutationObserver(this.handleMutation),"f")}observeMutations(t){ta.e(this,tn,"f")?.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})}destroy(){(0,ta.e)(this,ti,"f").disconnect(),(0,ta.e)(this,tn,"f").disconnect()}observeContainer(t){(0,ta.e)(this,ti,"f").observe(t)}unobserveContainer(t){(0,ta.e)(this,ti,"f").unobserve(t)}resizeElement(t){let e=this.layout.viewComponentsByContainerElement.get(t);e&&e.resize()}}ti=new WeakMap,tn=new WeakMap;var eR={};Object.defineProperty(eR,"__esModule",{value:!0});var eU=eR.BaseItem=void 0;class eV{constructor(t,e,i){this._item=t,this._layout=e,this._wrap=i}get raw(){return this._item}get layout(){return this._layout}get type(){return this._item.type}get contentItems(){return(this._item.contentItems??[]).map(t=>this._wrap(t))}get parent(){let t=this._item.parent;return t?this._wrap(t):null}setActiveContentItem(t,e){if("stack"!==this.type)throw Error(`Cannot call setActiveContentItem from a non-stack item: ${this.type}`);this._item.setActiveContentItem(t.raw,e)}static wrapInternal(t,e,i){let n=eV.wrapCache.get(e);if(n)return n;let o=new t(e,i,e=>eV.wrapInternal(t,e,i));return eV.wrapCache.set(e,o),o}}eU=eR.BaseItem=eV,eV.wrapCache=new WeakMap;let eO=t=>!!t&&"contentItems"in t&&(t.isRow||t.isColumn);class eB extends eU{isRoot(){return!!this._item.parent?.isGround}getBounds(){return this._item.element.getBoundingClientRect()}get viewName(){if(this._item.isComponent){let{component:t}=this._item;return t.identity.name}throw Error("View name not found")}onDestroyed(t){let e=({target:i})=>{i===this._item&&(t(),this._item.off("itemDestroyed",e))};this._item.on("itemDestroyed",e)}createAdjacentStack({position:t="right"}={}){let e=this.raw;if(e.parent){let i=["top","bottom"].includes(t)?"column":"row",n=["left","top"].includes(t)?1:0,o=eO(e.parent)?e.parent:e.layoutManager,s=e.parent.contentItems.indexOf(e);e.parent.isGround&&e.parent.removeChild(e,!0);let r=o.newItem({type:i,content:[{type:"stack",content:[]}]},s);if(!r)throw Error("createAdjacentStack: Failed to create new container");let a=r.contentItems[0];return r.addChild(this.raw,n),eO(o)&&o.removeChild(e,!0),this._wrap(a)}throw Error("Cannot create adjacent stack if no parent exists.")}setActiveContentItem(t,e=!0){if(!eC.isStack(this._item))throw Error(`Cannot call setActiveContentItem from a non-stack item: ${this.type}`);this._item.setActiveComponentItem(t.raw,!e)}static wrap(t,e){return eU.wrapInternal(eB,t,e)}}function eW(t=[],e){for(let i of t)"component"===i.type?Object.keys(e).forEach(t=>{t in i&&(i.componentState={[`${eM}${t}`]:i[t],...i.componentState}),i[t]=e[t]}):eW(i.content,e)}let eH=(t=[])=>{for(let e of t)if("component"===e.type&&"componentState"in e){let{componentState:t,...i}=e;"object"==typeof e.componentState&&(e.componentState={...e.componentState,...i})}else"content"in e&&eH(e.content)};class eF{static create(t){let e=document.createElement("of-view");return Object.entries(t).forEach(([t,i])=>{e.setAttribute(t,i)}),e}}customElements.define("of-view",(o=HTMLElement,class extends o{constructor(){super(...arguments),this.#t=null}#t;#e(){let t=this.iframe;t&&t.contentDocument?.head&&t.contentWindow&&window.top&&(0,ta.i)(t.contentWindow.window,window.top)&&(this.#t=(0,ta.g)(t.contentDocument.head,t=>this.dispatchEvent(new CustomEvent("page-title-updated",{detail:{title:t}}))))}#i(){this.#t&&(this.#t.disconnect(),this.#t=null)}get lastKnownUrl(){return this.iframe?.contentDocument?.location.href}connectedCallback(){if(!this.name||!this.uuid)throw Error("<of-view> Name or uuid attribute missing");if(!this.src)throw Error("<of-view> missing 'src' attribute.");if(!this.iframe){let t=document.createElement("iframe");t.addEventListener("load",()=>{this.#e()}),t.addEventListener("unload",()=>{this.#i()}),t.src=this.src,this.allow&&(t.allow=this.allow),t.style.height="100%",t.style.width="100%",t.style.border="none",this.forceFrameName?t.setAttribute("name",this.forceFrameName):t.setAttribute("name",(0,ta.f)({brokerUrl:this.brokerUrl,name:this.name,uuid:this.uuid,providerId:this.providerId,contextGroup:this.contextGroup},"of-frame")),t.setAttribute("id",this.name),this.appendChild(t)}}get iframe(){return this.querySelector(`iframe[id="${this.name}"]`)}get title(){return this.getAttribute("title")??this.iframe?.title??""}set title(t){this.setAttribute("title",t),this.iframe&&(this.iframe.title=t)}get brokerUrl(){return this.getAttribute("of-broker")}set brokerUrl(t){t&&this.setAttribute("of-broker",t)}get name(){return this.getAttribute("of-name")}set name(t){t&&this.setAttribute("of-name",t)}get forceFrameName(){return this.getAttribute("forceFrameName")}set forceFrameName(t){t&&this.setAttribute("forceFrameName",t)}get uuid(){return this.getAttribute("of-uuid")}set uuid(t){t&&this.setAttribute("of-uuid",t)}get src(){return this.getAttribute("src")}set src(t){t&&this.setAttribute("src",t)}get providerId(){return this.getAttribute("of-provider-id")}set providerId(t){t&&this.setAttribute("of-provider-id",t)}get contextGroup(){return this.getAttribute("of-context-group")}set contextGroup(t){t&&this.setAttribute("of-context-group",t)}get allow(){return this.getAttribute("allow")}set allow(t){t&&this.setAttribute("allow",t)}static get observedAttributes(){return["name"]}}));let eN=ta.h.getLogger("view-component");class e${constructor(t,e,i,{brokerUrl:n,interopConfig:o},s){this.container=t,this.componentState=e,this.ofView=null,this.isMinimised=!1,this.isActive=()=>this.container.tab.element.className.includes("lm_active")??!1,this.isDragging=()=>this.container.tab.element?.className.includes("lm_dragging")??!1;let{url:r,web:a,interop:l,name:h}=e,d=h??`internal-generated-view-${(0,td.Z)()}`;if(this.identity={uuid:i,name:d},this.container.element.setAttribute("of-name",d),this.container.element.id=`container-${d}`,this.container.parent.id=d,this.state={...e},void 0===r)return void this.handleUrlMissing();this.state.url=r,"view"!==this.container.parent.title&&(this.state.title=this.container.parent.title);let m={"of-broker":n,"of-uuid":i,"of-name":d,src:r};a?.frameName&&(m.forceFrameName=a.frameName);let c=l?.currentContextGroup??o?.currentContextGroup;c&&(m["of-context-group"]=c),o?.providerId&&(m["of-provider-id"]=o?.providerId),e?.permissions?.webAPIs&&(m.allow=this.applyWebAPIs(e.permissions.webAPIs),eN.debug(`Applying webAPIs: ${m.allow}`)),this.ofView=eF.create(m),this.setTitle(this.state.title),this.ofView.addEventListener("page-title-updated",({detail:t})=>{this.setTitle(t.title)}),s.appendChild(this.ofView),this.ofView.style.position="absolute"}applyWebAPIs(t){return t.reduce((t,e)=>{let i=(t=>{switch(t){case"clipboard-read":return"clipboard-read";case"clipboard-sanitized-write":return"clipboard-write";default:return""}})(e);return i?`${t} ${i} *;`.trim():t},"")}handleUrlMissing(){let t=document.createElement("div");t.setAttribute("style","padding: 20px"),t.innerText="No URL provided",this.container.element.appendChild(t)}destroy(){this.ofView?.remove(),this.ofView=null}closeView(){this.container.close()}setTitle(t){let e="options"===this.state.titlePriority?this.state.title||this.identity.name:t||this.state.title||this.ofView?.lastKnownUrl||this.state.url;e&&(eN.debug(`${this.identity.name} setting title to ${e}`),this.container.parent.setTitle(e),this.ofView&&(this.ofView.title=e))}setIsMinimised(t){this.isMinimised=t}toggleZIndex(t){this.ofView&&(this.ofView.style.zIndex=t?"99":"")}resize(){if(this.ofView){if(this.isDragging()||this.isMinimised)return void(this.ofView.style.display="none");let t=this.container.element.getBoundingClientRect();this.ofView.style.position="absolute",this.ofView.style.height=`${t.height}px`,this.ofView.style.width=`${t.width}px`,this.ofView.style.inset=`${t.top}px ${t.right}px ${t.bottom}px ${t.left}px`,this.ofView.style.display="block"}}}class ej extends tB{static overrideConfig(t){let e={...eA,...t.settings,...ek};return eH(t.content),e.reorderEnabled?eW(t.content,{isClosable:!0}):eW(t.content,{reorderEnabled:!1}),{dimensions:eT,...t,settings:e,header:{...eP,show:!1!==t.settings?.hasHeaders&&eP.show}}}constructor(t,e,i,{options:n},o,s){super(),this.identity=t,this.container=e,this.initialConfig=i,this.layoutManager=o,this.platformProvider=s,to.add(this),this.viewComponentsByContainerElement=new Map,this.events=new(th()),this.layoutContentCache=tL.getSingleInstance(),this.reparentingViews=new Set,this.goldenLayoutDestroyed=!1,this.createViewComponent=(t,e)=>{tI.handleSharedView(this.layoutManager,this.identity,e);let i=new e$(t,e,this.identity.uuid,this.options,this.iframeContainer);return e&&!1===e[`${eM}isClosable`]&&this.stylesheet.insertRule(`#tab-${i.identity.name} .lm_close_tab { display: none; }`),this.viewComponentsByContainerElement.set(t.element,i),this.resizeController.observeContainer(t.element),i},this.iframeContainer=document.createElement("div"),this.iframeContainer.id=`openfin-layout-iframe-container-${this.identity.layoutName}`,this.domEmitter=new tH(e),this.setupStylesheets(),this.layout=new ez(this.container),this.layout.resizeWithContainerAutomatically=!0,this.options=n,this.layout.registerComponent("view",this.createViewComponent),this.setupListeners(),s.registerEmitter(t.layoutName,this.events),this.resizeController=new eD(this);let r=ej.overrideConfig(i);this.layout.loadLayout(r),this.shadowContainer=document.createElement("div"),this.shadowContainer.id=`openfin-layout-shadow-container-${this.identity.layoutName}`,this.shadowContainer.attachShadow({mode:"open",delegatesFocus:!1}).appendChild(this.iframeContainer),this.container.appendChild(this.shadowContainer),this.resizeController.observeMutations(this.container)}getStackByView({name:t}){let e=this.layout.findFirstComponentItemById(t);if(e?.parent&&e?.parent?.isStack)return eB.wrap(e.parent,this)}getRoot(){return eB.wrap(this.layout.rootItem,this)}async platformCloseView(t){let e=(0,ta.e)(this,to,"m",ts).call(this,t.name);if(!e)throw Error(`View with name: ${t.name} not found in layout.`);e.closeView()}async platformCreateView(t,{location:e,targetView:i}={}){if(i)throw Error("TargetView not supported in web");let n={options:this.platformProvider.normalizeOptions(t),target:this.identity,location:e};return this.insertView(n)}setupStylesheets(){if(this.container.setAttribute("data-openfin-layout-name",this.identity.layoutName),this.stylesheet=new CSSStyleSheet,this.stylesheet.insertRule(".lm_close { display: none; }"),this.stylesheet.insertRule(".lm_maximise { opacity: 0.5; background-repeat: no-repeat; background-position: center; }"),this.stylesheet.insertRule(".lm_maximise:hover { opacity: 1; }"),document.adoptedStyleSheets.push(this.stylesheet),this.initialConfig.settings?.preventSplitterResize){let t=`
            [data-openfin-layout-name='${this.identity.layoutName}'] .lm_splitter {
                pointer-events: none;
            }`;this.stylesheet.insertRule(t)}}async insertView({options:t,location:e,targetView:i}){let n;let o=e?this.layoutContentCache.getItemOrUndefined(e.id):void 0,s=i?this.layoutContentCache.getItemOrUndefined(i.name):void 0,r=o??s??eB.wrap(this.layout.rootItem,this);if(eC.isStack(r.raw))n=r.raw;else{if(!eO(r.raw))throw Error("Cannot add a view at the requested location");n=r.raw.newItem({type:"stack",content:[]})}let a=Math.min(n.contentItems.length,e?.index??n.contentItems.length),l=this.layout.findFirstComponentItemById(t.name),h=n.getActiveComponentItem(),d=h?.focused;return l?(l.parent&&l.parent.removeChild(l,!0),n.addChild(l,a)):l=n.newComponent("view",t,t.title??t.url??"Default Title",a),"background"===(e?.displayState??"focused")&&h&&n.setActiveComponentItem(h,!!d),Promise.resolve({identity:l.component.identity})}async replaceView({viewToReplace:t,newView:e}){let i=this.getStackByView(t);if(!i)throw Error(`View with name: ${t.name} not found in layout.`);let n=i.contentItems.findIndex(e=>e.viewName===t.name);if(-1===n)throw Error(`View with name: ${t.name} not found in layout.`);if(t.name!==e.name){let o=this.layoutContentCache.getOrCreateEntityId(i),{identity:s}=await this.platformCreateView(e,{location:{id:o,index:n}});return await this.platformCloseView(t),{identity:s}}throw Error("Cannot replace a view with itself")}replaceLayout(t){throw Error("Method not implemented.")}async cleanupView(t){}applyPreset(t){throw Error("Method not implemented.")}getCurrentViews(){return[...this.viewComponentsByContainerElement.values()].map(t=>t.identity)}async getFrameSnapshot(){return function(t){if(t.root){t.root.content&&function t(e=[],i,n){for(let o of e)"component"===o.type?Object.keys(i).forEach(t=>{if(`${eM}${t}` in o.componentState)return o[t]=o.componentState[`${eM}${t}`],void delete o.componentState[`${eM}${t}`];o[t]=i[t]}):(o.size&&("row"===n||"column"===n)&&(o["row"===n?"width":"height"]=o.size?.includes(".")?parseFloat(o.size):parseInt(o.size)),t(o.content,i,o.type))}([t.root],{componentName:"view",isClosable:!0});let e=t.root;t.content=[e],delete t.root}return t}(tt.fromResolved(this.layout.toConfig()))}isVisible(){return t$(this.container)}async onViewDetached({viewIdentity:t}){this.reparentingViews.add(t.name),this.platformCloseView(t)}async destroy(){this.platformProvider.unregisterEmitter(this.identity.layoutName),this.goldenLayoutDestroyed||(this.goldenLayoutDestroyed=!0,this.layout.destroy()),this.iframeContainer.remove(),this.resizeController.destroy(),document.adoptedStyleSheets=document.adoptedStyleSheets.filter(t=>t!==this.stylesheet),this.viewComponentsByContainerElement.clear()}setupListeners(){this.container.addEventListener("pointerdown",t=>{if(t.target instanceof HTMLElement){let e=t.target.classList;["lm_tab","lm_title","lm_splitter","lm_drag_handle"].some(t=>e.contains(t))&&(this.handleDragStart(),2===t.button&&t.stopPropagation())}},!0),document.addEventListener("pointerup",()=>this.handleDragEnd(),!0),this.layout.on("tabCreated",t=>{let e=t.componentItem.component;t.element.id=`tab-${e.identity.name}`,this.domEmitter.dispatchLocalEvent("tab-created",e.identity)}),this.layout.on("itemCreated",({target:t})=>{if(eh.isComponentItem(t)){let e=t.component;this.domEmitter.dispatchLocalEvent("container-created",e.identity)}eC.isStack(t)&&(t.toggleMaximise=()=>this.toggleMaximise(t))}),this.layout.on("itemDestroyed",t=>{let e=t.target;if(eh.isComponentItem(e)){let t=e.component;this.removeViewComponent(t)}}),this.layout.on("itemDropped",()=>{this.handleDragEnd()}),this.events.on("page-title-updated",({data:{identity:t,title:e}})=>{this.identity.uuid===t.uuid&&ta.e(this,to,"m",ts).call(this,t.name)?.setTitle(e)})}handleDragStart(){this.iframeContainer.style.pointerEvents="none"}handleDragEnd(){this.iframeContainer.style.pointerEvents=""}toggleMaximise(t){let e=(t,e)=>{let i=this.layout.findFirstComponentItemById(t.identity.name);return i&&i.parent&&i.parent.isStack&&i.parent.element===e},i=[...this.viewComponentsByContainerElement.values()].filter(i=>!e(i,t.element)),n=[...this.viewComponentsByContainerElement.values()].find(i=>i.isActive()&&e(i,t.element)),o=(t,e)=>{t&&t.toggleZIndex(e)},s=t=>{i.forEach(e=>{e&&e.setIsMinimised(t)})};t.isMaximised?(t.minimise(),o(n,!1),s(!1)):(s(!0),t.maximise(),o(n,!0))}removeViewComponent(t){if(t.componentState&&!1===t.componentState[`${eM}isClosable`]){let e=[...this.stylesheet.cssRules].findIndex(e=>e.cssText.includes(`#tab-${t.identity.name}`));this.stylesheet.deleteRule(e)}t.destroy(),this.viewComponentsByContainerElement.delete(t.container.element),this.resizeController.unobserveContainer(t.container.element),this.reparentingViews.has(t.identity.name)?this.reparentingViews.delete(t.identity.name):this.platformProvider.closeView(t.identity.name),0===this.getCurrentViews().length&&(this.goldenLayoutDestroyed||(this.goldenLayoutDestroyed=!0,tI.handleLastViewRemoved(this.layoutManager,this.identity)))}}to=new WeakSet,ts=function(t){return[...this.viewComponentsByContainerElement.values()].find(e=>e.identity.name===t)};class eG{constructor(t,e,i,n){this.wire=t,this.connectConfig=e,this.provider=i,this.fallbackContainer=n,ta.L.setGlobalLogLevel(e.logLevel)}async createLayout(t,e){if(!("container"in t)&&!this.fallbackContainer)throw Error("Container property is not optional in web");let{layoutName:i}=t,n=this.provider.initLayoutViews(t),o=t.container??this.fallbackContainer,s=new ej({...this.wire.me,layoutName:i},o,n,this.connectConfig,e,this.provider);tI.registerLayout(e,i,s),this.fallbackContainer=null}async getLayoutSnapshot(t){return t.getLayoutSnapshot()}async handleLastViewRemoved(t){}getWire(){return this.wire}}class eZ{static async init(t){let e=t.getFin().InterApplicationBus.Channel,i=await e.create(`custom-frame-${t.me.uuid}`);i.setDefaultAction(async(t,{target:e,opts:n},o)=>{let s=i.connections.find(t=>t.name===e.name);if(s)return i.dispatch(s,t,{...n,target:e});throw Error(`Client with name ${e.name} not found`)}),await (0,ta.r)(i,"layout-relay");let n=await e.create((0,ta.j)(t));return new eZ(t,n)}constructor(t,e){this.wire=t,this.dataChannelProvider=e,this.emitters=new Map,this.viewNames=new Set,e.register("page-title-updated",t=>{[...this.emitters.values()].forEach(e=>{e.emit("page-title-updated",t)})})}registerEmitter(t,e){this.emitters.set(t,e)}unregisterEmitter(t){this.emitters.delete(t)}normalizeOptions(t,e="default"){let i=this.wire.me.uuid,{name:n=`internal-generated-view-${(0,td.Z)()}`}=t;return n.match(/^internal-generated-view-/)&&this.viewNames.has(n)&&"duplicate"===e&&(n=`internal-generated-view-${(0,td.Z)()}`),this.viewNames.add(n),{...t,name:n,uuid:i}}closeView(t){this.viewNames.delete(t)}initLayoutViews({layout:t,multiInstanceViewBehavior:e}){return tN(t=>{if("component"===t.type&&t.componentState){let i=this.normalizeOptions(t.componentState,e);return{...t,componentState:i}}return t},t)}}let eq=t=>t;class eX{constructor(t){tr.set(this,void 0),this.initLayoutManager=async(t,e,{container:i,layoutManagerOverride:n})=>{let o=await eZ.init(e),s=new eG(e,(0,ta.e)(this,tr,"f"),o,i),r=new((n??eq)(tI.createClosedConstructor(s)));return await tR(e,r),r},this.applyLayoutSnapshot=async(t,e,i)=>{await e.applyLayoutSnapshot((0,ta.e)(this,tr,"f").platform.layoutSnapshot)},this.createLayout=async(t,e)=>tI.createLayout(t,e),this.destroyLayout=async(t,e)=>tI.destroyLayout(t,e),(0,ta._)(this,tr,t,"f")}}tr=new WeakMap}}]);